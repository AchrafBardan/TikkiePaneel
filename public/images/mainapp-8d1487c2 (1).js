!function(){function e(e){return{request:function(e){return e},requestError:function(t){return e.reject(t)},response:function(e){return e},responseError:function(t){return e.reject(t)}}}angular.module("eddieportal").factory("httpInterceptor",e),e.$inject=["$q"]}(),function(){function e(e,t,n,a,o,i,r,s){e.sendWhatsAppMessage=function(){var e=this;e.data=n,"ios"==e.data.os&&(a.location.href="../../resources/TikkieSupport.vcf")},e.sendWhatsAppMessageWV=function(){var e=this;e.data=n,"ios"==e.data.os&&(a.location.href="../../resources/TikkieSupport.vcf")},e.checkMobileResolution=function(){a.innerWidth<768?e.mobile=!0:e.mobile=!1},angular.element(a).bind("resize",function(){e.checkMobileResolution()});var l=function(){e.API_URL="https://"+s.apiurl();var n=window.location.pathname,a=n.substr(19,2);"nl"==a||"en"==a?e.language=a:e.language=r.browserSettings(),e.languageFile=e.language+".json",e.faqFile=e.language+"_faq.json",t.content(e.languageFile).then(function(t){e.content=t.data,e.title=e.content.howpayworks_title,e.descr=e.content.howpayworks_descr,e.questions=e.content.any_questions,e.chat=e.content.chat_with_Tikkie_btn}),e.whatsapp="./images/whats-app-logo.png",e.currentYear=(new Date).getFullYear(),e.pageClass="page-faq",e.imglogo="./images/tikkie-app-logo.png",e.imgfacebook="./images/facebook.svg",e.imginsta="./images/instagram-icon.svg",t.content(e.faqFile).then(function(t){e.panes=t.data,e.items=[];for(var n=0;n<e.panes.length;n++){var a={};if(a.category=o.trustAsHtml(e.panes[n].category),a.header=o.trustAsHtml(e.panes[n].header),e.input=e.panes[n].content,"nl"==e.language){var i={linkInstantPayments:"https://www.betaalvereniging.nl/betalingsverkeer/instant-payments/",linkCustomerRights:"https://www.abnamro.nl/nl/prive/abnamro/privacy/klantrechten.html"};e.output=e.input.replace(/linkInstantPayments|linkCustomerRights/g,function(e){return i[e]})}else{var i={linkInstantPayments:"https://www.betaalvereniging.nl/en/focus/instant-payments/",linkCustomerRights:"https://www.abnamro.nl/en/personal/overabnamro/privacy/client-rights.html"};e.output=e.input.replace(/linkInstantPayments|linkCustomerRights/g,function(e){return i[e]})}a.content=o.trustAsHtml(e.output),e.items.push(a)}}),e.checkMobileResolution()};l()}angular.module("eddieportal").controller("FaqController",e),e.$inject=["$scope","PageContent","deviceDetector","$window","$sce","$http","languageSettingsService","Api"]}(),function(){function e(e,t,n,a,o,i,t,r,s){e.getCookieSettings=function(){"true"==i.get("cookieTarget")?e.checkboxTarget={value:!0}:e.checkboxTarget={value:!1},"true"==i.get("cookieSocial")?e.checkboxSocial={value:!0}:e.checkboxSocial={value:!1},e.checkboxFunctional={value:!0},e.checkboxAnalytic={value:!0}},e.changeCookieSettings=function(){var t=new Date;t.setDate(t.getDate()+365),1==e.checkboxTarget.value?i.put("cookieTarget","true",{expires:t}):i.put("cookieTarget","false",{expires:t}),1==e.checkboxSocial.value?i.put("cookieSocial","true",{expires:t}):i.put("cookieSocial","false",{expires:t}),o.history.go(-1)},e.cancelSettings=function(){o.history.back()},e.$on("$locationChangeStart",function(t,n,a){e.previousUrl=a}),e.checkMobileResolution=function(){o.innerWidth<768?e.mobile=!0:e.mobile=!1},angular.element(o).bind("resize",function(){e.checkMobileResolution()});var l=function(){e.imgerror="./images/hardlopers3.gif",e.API_URL="https://"+n.apiurl(),e.pageClass="page-cookies",e.getCookieSettings(),e.imgArrowLeft="./images/arrow-left.png",e.iconCheck="./images/check-icon-verified-green.svg",r.scrollTopAnimated(0,200)};l()}angular.module("eddieportal").controller("CookiesController",e),e.$inject=["$scope","PageContent","Api","deviceDetector","$window","$cookies","PageContent","$document","$timeout"]}(),function(){function e(e,t,n,a,o){e.sendWhatsAppMessage=function(){var e=this;e.data=n,"ios"==e.data.os&&(a.location.href="../../resources/TikkieSupport.vcf")},e.sendWhatsAppMessageWV=function(){var e=this;e.data=n,"ios"==e.data.os&&(a.location.href="../../resources/TikkieSupport.vcf")},e.checkMobileResolution=function(){a.innerWidth<768?e.mobile=!0:e.mobile=!1},angular.element(a).bind("resize",function(){e.checkMobileResolution()});var i=function(){e.pageClass="page-about",e.imglogo="./images/tikkie-app-logo.png",e.imgfacebook="./images/facebook.svg",e.imginsta="./images/instagram-icon.svg",t.content("faq.json").then(function(t){e.panes=t.data}),e.checkMobileResolution()};i()}angular.module("eddieportal").controller("AboutController",e),e.$inject=["$scope","PageContent","deviceDetector","$window","$sce"]}(),function(){function e(e,t,n,a,o,r,s,l,c,g,t,u){function d(){var t=BUSINESS_API_URL,n={method:"GET",url:t+"/ideal/issuers"};s(n).then(function(t){e.issuers=t.data,e.issuers.splice(0,0,{code:"selectBank",name:"Kies je bank",up:!0}),p()},function(t){gtag("event","Backend not available",{event_category:"Error business",event_label:e.paymentEventToken}),a.location.href="/#/niet-beschikbaar/"})["finally"](function(){})}function p(){var t=u.get("cookieIssuer");if(void 0!=t)for(e.paidBefore=!0,i=1;i<e.issuers.length;i++)e.issuers[i].code==t&&(e.selectedIssuer=e.issuers[i],e.GetSelectedIssuer(e.issuers[i]));else e.selectedIssuer=e.issuers[0],e.firstPayment=!0,e.loadSuccess=!0;g(function(){e.loadSuccess=!0},1e3)}var m;e.runCaptcha=function(t){window.scrollTo(0,0),e.loading="Bon wordt geladen...",e.loadSuccess=!1,gtag("event","horeca_enterTableNumber_nextButton",{event_category:"Tikkie check",event_restaurant:e.restaurantToken}),grecaptcha.execute("6LdyrvYUAAAAANlp7Jge5bPDfhT1R4X94ibZ4KEZ",{action:"table_selection"}).then(function(n){e.openBill(n,t)})},e.openBill=function(t,n){e.nextEnabled=!1,e.order=!1,e.tableNumber=n,e.recaptchaToken=t;var o={method:"GET",headers:{"Access-Control-Allow-Origin":e.environment,Recaptcha:t},url:e.HORECA_API_URL+"/table/"+e.restaurantToken+"/"+e.tableNumber};s(o).then(function(t){if(t.data.orderId)e.order=!0,e.orderId=t.data.orderId,k(),e.recaptchaToken="",e.getOrder(e.orderId);else{e.tablenr=!0,e.orderId=t.data.orderId,g(function(){e.loadSuccess=!0},1e3),e.bill=!1}e.order||h("table")},function(t){e.loadSuccess=!0,403==t.status?(k(),e.orderId="",e.recaptchaToken="",e.tableNumber="",e.order=!1,e.tablenr=!1,e.bill=!1):a.location.href="/#/niet-beschikbaar/"})["finally"](function(){})},e.getOrder=function(t){var n={method:"GET",headers:{"Access-Control-Allow-Origin":e.environment},url:e.HORECA_API_URL+"/order/"+t};s(n).then(function(e){f(e)},function(t){e.loadSuccess=!0,400==t.status?a.location.href="/#/niet-gevonden/":a.location.href="/#/niet-beschikbaar/"})["finally"](function(){})};var k=function(){g.cancel(m)},h=function(t){k(),"table"===t?m=g(function(){e.openBill(e.recaptchaToken,e.tableNumber)},5e3):"order"===t&&(m=g(function(){e.getOrder(e.orderId)},5e3))},f=function(t){if(t.data.orderId){e.tablenr=!0;e.value++,1===e.value&&(e.refId=t.data.orderId),e.refId==t.data.orderId&&"NOT_ALLOWED"!==t.data.tikkieStatus&&"PAID_UNCONFIRMED"!==t.data.tikkieStatus&&"PAID"!==t.data.tikkieStatus||(e.payerPaid=!0,e.payEnabled=!1,e.cannotPayTitle=e.billClosed_title,e.cannotPayMsg=e.paybill_share_msg,"PAID_UNCONFIRMED"!=t.data.tikkieStatus&&(e.stopPolling=!0),e.emoji="ðŸ‘",gtag("event","horeca_getTableDetails_billClosedMessage",{event_category:"Tikkie check",event_restaurant:e.restaurantToken})),"PAYING"===t.data.tikkieStatus&&(e.payerPaid=!0,e.payEnabled=!1,e.cannotPayTitle=e.paying_title,e.cannotPayMsg=e.paybill_share_msg,e.emoji="ðŸ™‹â€â™€ï¸",gtag("event","horeca_getTableDetails_alreadyPayingMessage",{event_category:"Tikkie check",event_restaurant:e.restaurantToken})),"NOT_AVAILABLE"===t.data.tikkieStatus&&(e.payerPaid=!0,e.payEnabled=!1,e.cannotPayTitle=e.unavailable_title,e.cannotPayMsg=e.unavailable_msg),t.data.totalPriceInCentsVAT>0&&"ALLOWED"===t.data.tikkieStatus&&(e.payEnabled=!0,e.payerPaid=!1),e.invoiceDate=t.data.currentDateFormatted,t.data.amountPaidInCents>0&&t.data.amountPaidInCents<t.data.totalPriceInCentsVAT?(e.partialPayment=!0,e.rawAmount=t.data.amountOpenInCents,e.totalAmount=b(t.data.amountOpenInCents),e.amountOpenInCents=b(t.data.amountOpenInCents),e.amountPaidInCents=b(t.data.amountPaidInCents)):(e.rawAmount=t.data.totalPriceInCentsVAT,e.totalAmount=b(t.data.totalPriceInCentsVAT)),e.totalAmountOnReceipt=b(t.data.totalPriceInCentsVAT),e.totalExclVat=b(t.data.totalPriceInCents),t.data.totalVatHighInCents>0&&(e.vatHigh=!0,e.totalVatHighInCents=b(t.data.totalVatHighInCents)),t.data.totalVatLowInCents>0&&(e.vatLow=!0,e.totalVatLowInCents=b(t.data.totalVatLowInCents)),e.items=[];for(var n=0;n<t.data.orderItems.length;n++){e.bill=!0;var a={};a.itemName=t.data.orderItems[n].itemName,a.singlePriceInCentsVAT=b(t.data.orderItems[n].singlePriceInCentsVAT),a.totalPrice=b(t.data.orderItems[n].totalPriceInCentsVAT),a.quantity=t.data.orderItems[n].quantity,e.items.push(a)}1===e.value&&window.scrollTo(0,0),g(function(){e.loadSuccess=!0},1e3)}e.stopPolling||e.tippie?k():h("order")};e.$on("$destroy",function(){k()}),e.finalizeOrder=function(){window.scrollTo(0,0),e.loading="Betaling wordt gestart...",e.loadSuccess=!1;var t=new Date;t.setDate(t.getDate()+365),u.put("cookieIssuer",e.selectedIssuer.code,{expires:t}),u.put("cookieBankName",e.selectedIssuer.name,{expires:t});var n={method:"POST",headers:{"Access-Control-Allow-Origin":e.environment},data:{merchantToken:e.restaurantToken,orderId:e.refId,tipInCents:e.tipinCents,tipType:e.tipType,issuerCode:e.issuerCode},url:e.HORECA_API_URL+"/table/finalize"};s(n).then(function(t){g(function(){e.loadSuccess=!0},1e3);var n=t.data.url;a.location.href=n,gtag("event","horeca_chooseTip_payNowButton",{event_category:"Tikkie check",event_restaurant:e.restaurantToken,event_tip_type:e.tipType,event_tip_in_cents:e.tipinCents})},function(t){switch(g(function(){e.loadSuccess=!0},1e3),t.data.status){case 409:var n={method:"GET",headers:{"Access-Control-Allow-Origin":e.environment},url:e.HORECA_API_URL+"/order/"+e.orderId};s(n).then(function(t){"NOT_ALLOWED"===t.data.tikkieStatus||"PAID_UNCONFIRMED"===t.data.tikkieStatus||"PAID"===t.data.tikkieStatus?(e.showMessage=!0,e.cannotPay2Title=e.billClosed_title,e.cannotPay2Msg=e.paybill_share_msg,e.emoji="ðŸ‘",e.bankSelected=!1):(e.showMessage=!0,e.cannotPay2Title=e.paying_title,e.cannotPay2Msg=e.paybill_share_msg,e.emoji="ðŸ™‹â€â™€ï¸")},function(e){})["finally"](function(){});break;default:gtag("event","Cancelled payment",{event_category:"Error business",event_label:e.paymentEventToken}),a.location.href="/#/servererror/"}})["finally"](function(){})},e.payBill=function(){e.tippie=!0,e.payEnabled=!1,e.count=0,k();var t=parseInt(e.rawAmount);switch(!0){case t<4e3:var n=t/100*10;break;case t<7e3:var n=t/100*8;break;case t<1e4:var n=t/100*6;break;case t<12e3:var n=t/100*5;break;case t<25e3:var n=t/100*4;break;case t>=25e3:var n=t/100*4}var a=parseInt(n);e.tipRound=a;var o=(t+n)/100;if(o<20){var i=Math.ceil(10*o)/10,r=Number.isInteger(i);i+=r?".00":"0",e.roundAmount=i.replace(".",","),e.twoDecimals=!0}else e.roundAmount=Math.round(o),e.twoDecimals=!1;e.subAmount=e.totalAmount,e.tip="0,00",e.totalAmountInc=e.totalAmount,window.scrollTo(0,0),gtag("event","horeca_getTableDetails_payNowButton",{event_category:"Tikkie check",event_restaurant:e.restaurantToken})},e.roundTip=function(){e.tipGif=!1,e.roundTipGif=!0,e.chooseTipGif=!1,e.noTipGif=!1,e.tipType="rounded",e.keepbgGreen1=!0,e.keepbgGreen2=!1,e.keepbgGreen3=!1;var t;t=e.twoDecimals?parseFloat(e.roundAmount.replace(/,/g,".")).toFixed(2):e.roundAmount,e.keepbgGreen2=!1,e.tipSelected=!0,e.amountWithTip=100*t,e.tip=parseInt(e.amountWithTip)-parseInt(e.rawAmount),e.totalAmountInc=parseInt(e.tip)+parseInt(e.rawAmount),e.twoDecimals?(e.cents=e.totalAmountInc%100,e.totalAmountInc=e.totalAmountInc/100,e.totalAmountInc=e.totalAmountInc.toString(),e.totalAmountInc=e.totalAmountInc.replace(".",","),0===e.cents?e.totalAmountInc=e.totalAmountInc+",00":e.totalAmountInc=e.totalAmountInc+"0"):e.totalAmountInc=e.totalAmountInc/100+",00",e.tipinCents=e.tip,e.tip=b(e.tipinCents),g(function(){var e=angular.element(document.getElementById("bottom"));o.scrollToElementAnimated(e)},1e3)},e.chooseTip=function(){e.tipGif=!1,e.roundTipGif=!1,e.chooseTipGif=!0,e.noTipGif=!1,e.keepbgGreen1=!1,e.keepbgGreen2=!1,e.keepbgGreen3=!1,e.showGlass=!0,e.tooLow=!1,e.tip="0,00",e.totalAmountInc=e.totalAmount,g(function(){window.scrollTo(0,0)},500)},e.addTip=function(t){var n=parseFloat(t.replace(/,/g,".")).toFixed(2),a=Math.round(100*n);a>=e.rawAmount?(e.tooLow=!1,e.totalAmountInc=b(a),e.showGlass=!1,e.count=0,e.nextEnabled=!1,e.tip=a-parseInt(e.rawAmount),e.tipinCents=e.tip,e.tip=b(e.tipinCents),e.keepbgGreen1=!1,e.keepbgGreen2=!0,e.keepbgGreen3=!1,e.tipSelected=!0,e.tipType="manual",g(function(){var e=angular.element(document.getElementById("bottom"));o.scrollToElementAnimated(e)},1e3)):(e.keepbgGreen1=!1,e.keepbgGreen2=!1,e.keepbgGreen3=!1,e.tooLow=!0,e.addAmount=e.tipTooLow.replace("#amount",e.totalAmount),e.tipTooLow_msg=r.trustAsHtml(e.addAmount))},e.closeModal=function(){e.tipType="",e.showGlass=!1,e.tooLow=!1,e.keepbgGreen2=!1,e.count=0,e.nextEnabled=!1,this.tipAmount="",e.tipinCents="0",e.tipSelected=!1},e.closeModal2=function(){e.showMessage=!1},e.noTip=function(){e.tipGif=!1,e.roundTipGif=!1,e.chooseTipGif=!1,e.noTipGif=!0,e.tipType="none",e.tipinCents="0",e.keepbgGreen1=!1,e.keepbgGreen2=!1,e.keepbgGreen3=!0,e.tipSelected=!0,e.tip="0,00",e.totalAmountInc=e.totalAmount,g(function(){var e=angular.element(document.getElementById("bottom"));o.scrollToElementAnimated(e)},1e3)};var b=function(t){return e.cents=t%100,e.euro=Math.floor(t/100),e.cents<0&&(e.cents=e.cents*-1),e.cents<10&&(e.cents="0"+e.cents),e.euro+","+e.cents};e.closeBanner=function(){e.tooLow=!1},e.acceptButton=function(){e.acceptTerms=!0,e.qrReceipt&&e.qrOnReceipt(),window.scrollTo(0,0);var t=new Date;t.setDate(t.getDate()+365),u.put("HorecaTerms",!0,{expires:t}),gtag("event","horeca_termsOfUse_acceptButton",{event_category:"Tikkie check",event_restaurant:e.restaurantToken})},e.handleChange=function(t){void 0===t||0===t.length?e.nextEnabled=!1:e.nextEnabled=!0},e.checkMobileResolution=function(){a.innerWidth<768?e.mobile=!0:e.mobile=!1},e.getRestaurantLocation=function(){if(!e.qrReceipt){var t=window.location.pathname,n=t.lastIndexOf("/"),a=t.substring(n+1);e.restaurantToken=a}"taphuys"===e.restaurantToken?(e.location=!0,e.brandLogo="./images/horeca/8Y1lZJXABG8ENRbjQJVlFHR2xSEUglwuvt4NmhsH.png"):e.getBrandImages(),window.scrollTo(0,0)},e.determineLocation=function(t){switch(e.nextEnabled=!0,t){case 1:e.restaurantToken="C8II7absCR",e.purple1=!0,e.purple2=!1,e.purple3=!1;break;case 2:e.restaurantToken="PXNq6GIaWZ",e.purple1=!1,e.purple2=!0,e.purple3=!1;break;case 3:e.restaurantToken="Euk3w0GbR6",e.purple1=!1,e.purple2=!1,e.purple3=!0}},e.putLocation=function(){e.location=!1,e.nextEnabled=!1,e.getBrandImages(),window.scrollTo(0,0),gtag("event","horeca_locationTaphuys_nextButton",{event_category:"Tikkie check",event_restaurant:e.restaurantToken})},e.getBrandImages=function(){e.brandLogo="",e.brandName="";var t={method:"GET",headers:{"Access-Control-Allow-Origin":e.environment},url:e.HORECA_API_URL+"/merchant/"+e.restaurantToken};s(t).then(function(t){e.brandLogo=t.data.merchantLandingPageLogo,e.brandName=t.data.merchantName;var n=new Date;n.setDate(n.getDate()+14),u.put(e.restaurantToken,e.brandLogo,{expires:n})}),e.brandImage="./images/horeca-3.png"},angular.element(a).bind("resize",function(){e.checkMobileResolution()}),e.getFeatures=function(){var t={method:"GET",url:e.API_URL+"/toggles/features"};s(t).then(function(t){for(var n=0;n<t.data.length;n++){var a=t.data[n];"horeca-mvp"===a&&(e.horeca=!0)}})},e.getEnvironment=function(){var t="",n=window.location.hostname;t=n.substr(0,3),"dev"==t||"tst"==t||"acc"==t?e.environment="https://"+t+".tikkie.me":e.environment="https://tikkie.me"},e.qrOnReceipt=function(){var t=window.location.pathname,n=t.substr(4);n=encodeURIComponent(n),e.recaptchaToken="a8382ea4-27a3-4f5a-aed5-0a3520c2090b";var o={method:"GET",headers:{"Access-Control-Allow-Origin":e.environment,Recaptcha:e.recaptchaToken},url:e.HORECA_API_URL+"/table/qr/"+n};s(o).then(function(t){e.orderId=t.data.orderId,e.tableNumber=t.data.tableNumber,e.restaurantToken=t.data.restaurantToken,e.getRestaurantLocation(),f(t)},function(t){404==t.status&&(e.orderId="",e.recaptchaToken="",e.tableNumber="",e.order=!1,e.tablenr=!1,e.bill=!1,a.location.href="/#/bon-niet-gevonden/")})["finally"](function(){})},e.GetSelectedIssuer=function(t){e.selectedIssuer=t,1==t.up?(e.idealIssuerDown=!1,"selectBank"===t.code?(e.issuerCode="",e.payEnabled=!1,e.bankSelected=!1):(e.issuerCode=t.code,e.payEnabled=!0,e.bankSelected=!0)):(e.issuerCode="",e.bankSelected=!1,e.payEnabled=!1,e.idealIssuerDown=!0,gtag("event","Ideal issuer down",{event_category:"Payment page business",event_label:$issuer.name}))};var v=function(){e.loadSuccess=!1,e.API_URL="https://"+l.apiurl(),e.HORECA_API_URL="https://"+l.horecaapiurl(),BUSINESS_API_URL="https://"+l.businessapiurl(),e.count=0,e.bill=!1,e.tablenr=!1,e.nextEnabled=!1,e.tipSelected=!1,e.payEnabled=!1,e.payEnabled=!1,e.horeca=!1,e.qrReceipt=!1,e.location=!1,e.value=0,e.tippie=!1,e.tooLow=!1,e.purple1=!1,e.purple2=!1,e.purple3=!1,e.tikkieLogo="./images/tikkie-app-logo.png",e.paidimg1="./images/dancingWaiter.gif",e.paidimg2="./images/waiter.gif",e.paidimg3="./images/sadDog.gif",e.paidimg="./images/waiter.gif",e.tipGif=!0,e.imggoogleicon="./images/google-store.svg",e.imgappleicon="./images/apple.svg",e.imgdesktop="./images/asset-desktop@2x.jpg",e.imgloader="./images/loader.gif",e.imgtikkielogo="./images/logo-tikkie.png",e.wallpaper="./images/horeca-wallpaperv2.jpg",e.arrowgif="./images/arrow-copy.png",e.gif="./images/download-app.gif",e.personalBg="brand-image",e.iconCheck="./images/check-icon-verified.svg",e.close="./images/Cross-grey.svg",e.close2="./images/Cross.svg",e.currentYear=(new Date).getFullYear();var a=this;a.data=n,"ios"===a.data.os?e.os="ios":"android"===a.data.os?e.os="android":e.os="other";var o=window.location.pathname,i=o.substr(0,4);"/qr/"==i&&(e.qrReceipt=!0,e.loading="Bon wordt geladen..."),e.language="nl",e.languageFile=e.language+".json",e.faqFile=e.language+"_faq.json",t.content(e.languageFile).then(function(t){e.content=t.data,e.qrReceipt||(e.loading=e.content.page_loading),e.title=e.content.paybill_title,e.descr=e.content.howpayworks_descr,e.questions=e.content.any_questions,e.chat=e.content.chat_with_Tikkie_btn,e.footer_terms_check=e.content.footer_terms_check,e.footer_terms_check=r.trustAsHtml(e.footer_terms_check),e.footer_privacy_web=e.content.footer_privacy_web,e.footer_privacy_web=r.trustAsHtml(e.footer_privacy_web),e.no_order=e.content.paybill_no_order,e.table_title=e.content.paybill_table_title,e.table=e.content.paybill_table,e.table_placeholder=e.content.paybill_table_placeholder,e.next=e.content.next,e.total=e.content.paybill_total,e.pay_now=e.content.pay_now,e.tippie_title=e.content.tippie_title,e.explanation_1=e.content.paybill_explanation_1,e.explanation_2=e.content.paybill_explanation_2,e.explanation_3=e.content.paybill_explanation_3,e.billClosed_title=e.content.paybill_closed_Title,e.paying_title=e.content.paybill_paying_title,e.paybill_share_msg=e.content.paybill_share_msg,e.paybill_share_msg=r.trustAsHtml(e.paybill_share_msg),e.unavailable_title=e.content.paybill_unavailable_title,e.unavailable_msg=e.content.paybill_unavailable_msg,e.unavailable_msg=r.trustAsHtml(e.unavailable_msg),e.alreadyPaid=e.content.paybill_alreadyPaid,e.outstandingAmount=e.content.paybill_outstandingAmount,e.accept=e.content.accept,e.horecaTermsTitle=e.content.horecaTerms_Title,e.horecaTermsTitle=r.trustAsHtml(e.horecaTermsTitle),e.horecaTermsSubTitle=e.content.horecaTerms_SubTitle,e.horecaTermsSubTitle=r.trustAsHtml(e.horecaTermsSubTitle),e.horecaTermsDescription=e.content.horecaTerms_desc,e.horecaTermsDescription=r.trustAsHtml(e.horecaTermsDescription),e.horecaLocationTitle=e.content.horeca_location_Title,e.horecaLocationTitle=r.trustAsHtml(e.horecaLocationTitle),e.tippieAmount=e.content.tippie_amount,e.round=e.content.tippie_round,e.choose=e.content.tippie_choose,e.notip=e.content.tippie_notip,e.sub=e.content.tippie_subAmount,e.chooseTipTitle=e.content.chooseTip_title,e.chooseTipDescription=e.content.chooseTip_msg,e["continue"]=e.content["continue"],e.tipTooLow=e.content.chooseTip_tooLow}),t.content(e.faqFile).then(function(t){e.panes=t.data,e.items=[];for(var n=0;n<e.panes.length;n++){var a={};a.category=r.trustAsHtml(e.panes[n].category),a.header=r.trustAsHtml(e.panes[n].header),a.content=r.trustAsHtml(e.panes[n].content),e.items.push(a)}}),e.checkMobileResolution(),"true"==u.get("HorecaTerms")?(e.acceptTerms=!0,window.scrollTo(0,0)):(e.acceptTerms=!1,gtag("event","horeca_termsOfUse_openPage",{event_category:"Tikkie check",event_restaurant:e.restaurantToken})),e.getFeatures(),e.getEnvironment(),e.acceptTerms&&e.qrReceipt&&e.qrOnReceipt(),e.qrReceipt||e.getRestaurantLocation(),d(),window.scrollTo(0,0),g(function(){e.loadSuccess=!0},1e3)};v()}angular.module("eddieportal").controller("HorecaCtrl",e),e.$inject=["$scope","PageContent","deviceDetector","$window","$document","$sce","$http","Api","languageSettingsService","$timeout","PageContent","$cookies"]}(),function(){function e(e,t,n,a,o){function i(){switch(e.path()){case"/voorwaardenv2":t.newUrlScheme=!1,t.version=3;break;case"/voorwaarden/nl/v2/":t.language="nl",t.newUrlScheme=!0,t.version=3;break;case"/voorwaarden/en/v1/":t.newUrlScheme=!0,t.language="en",t.version=1;break;default:t.newUrlScheme=!1,t.language="nl",t.version=1}}function r(){t.version<l&&n.content("terms.json").then(function(e){t.terms=e.data})}function s(){t.showIOS=o.isIOS(),t.showAndroid=o.isAndroid()}var l=3;t.downloadPDF=function(){"nl"===t.language&&3===t.version&&t.newUrlScheme===!0&&(t.version=t.version-1),o.isAndroid()?tikkie.downloadTerms():a.location.href=t.getDownloadLink()},t.isVersion=function(e){return t.version===e},t.getDownloadLink=function(){return t.newUrlScheme===!1?"../../resources/tikkie_voorwaarden_v"+t.version+".pdf":t.newUrlScheme===!0?"../../resources/voorwaarden_"+t.language+"_v"+t.version+".pdf":void 0};var c=function(){t.whatsapp="./images/whats-app-logo.png",i(),r(),s()};c()}angular.module("eddieportal").controller("TermsAppController",e),e.$inject=["$location","$scope","PageContent","$window","mobileUtils"]}(),function(){function e(e,t,n,a,o){function i(){t.content("termspay.json").then(function(t){e.terms=t.data})}e.sendWhatsAppMessage=function(){o.isIOS()&&(a.location.href="../../resources/TikkieSupport.vcf")},i()}angular.module("eddieportal").controller("TermsWebController",e),e.$inject=["$scope","PageContent","deviceDetector","$window","mobileUtils"]}(),function(){function e(e,t,n,a,o,i,r,s){e.currentIndex=function(t){switch(t){case 0:e.atSection1=!0,e.atSection2=!1,e.atSection3=!1,e.atSection4=!1,e.showButton=!0;break;case 1:e.atSection1=!1,e.atSection2=!0,e.atSection3=!1,e.atSection4=!1,e.showButton=!0;break;case 2:e.atSection1=!1,e.atSection2=!1,e.atSection3=!0,e.atSection4=!1,e.showButton=!0;break;case 3:e.atSection1=!1,e.atSection2=!1,e.atSection3=!1,e.atSection4=!0,e.showButton=!1;break;default:e.atSection1=!0,e.showButton=!0}},e.nextPage=function(t){e.snapIndex=t,angular.element(document.getElementById("arrowDown")).remove()},e.previousPage=function(t){e.snapIndex=t,e.atSection2=!1,e.atSection3=!1,e.atSection4=!1},e.gotoPage=function(t){e.snapIndex=t},e.setCookieSettings=function(){var e=new Date;e.setDate(e.getDate()+365),i.put("cookieSocial","true",{expires:e}),i.put("cookieTarget","true",{expires:e})},e.getCookieSettings=function(){void 0==i.get("cookieTarget")?(e.showToaster=!0,e.setCookieSettings()):e.showToaster=!1,"true"==i.get("cookieTarget")&&(e.pixelTarget=!0),"true"==i.get("cookieSocial")&&(e.pixelSocial=!0)},e.closeCookieToaster=function(){e.showToaster=!1},e.checkMobileResolution=function(){a.innerWidth<768?e.mobile=!0:e.mobile=!1},angular.element(a).bind("resize",function(){e.checkMobileResolution()}),e.downloadApp=function(t){"ios"==e.os?a.location.href="https://itunes.apple.com/nl/app/tikkie/id1112935685?l=nl&ls=1&mt=8":"android"==e.os&&(a.location.href="https://play.google.com/store/apps/details?id=com.abnamro.nl.tikkie"),"ios"==t?a.location.href="https://itunes.apple.com/nl/app/tikkie/id1112935685?l=nl&ls=1&mt=8":"android"==t&&(a.location.href="https://play.google.com/store/apps/details?id=com.abnamro.nl.tikkie")},e.downloadPrivacyPolicy=function(){"nl"===e.language&&e.newUrlScheme===!1&&2===e.version&&(e.version=e.version+1),s.isAndroid()?(e.newUrlScheme?e.downloadLink_AND="/resources/privacyverklaring_app_"+e.language+"_v"+e.version+".pdf":e.downloadLink_AND="/resources/privacyverklaring_app_"+e.version+".pdf",tikkie.downloadPrivacyStatement(e.downloadLink_AND)):(e.newUrlScheme?e.downloadLink_IOS="../../resources/privacyverklaring_app_"+e.language+"_v"+e.version+".pdf":e.downloadLink_IOS="../../resources/privacyverklaring_app_"+e.version+".pdf",a.location.href=e.downloadLink_IOS)};var l=function(){e.pageClass="page-home",e.mobile=!1,e.imglogo="./images/tikkie-app-logo.png",e.imgwhatsapp1="./images/tikkie-app-whatsapp-1.png",e.imgwhatsapp2="./images/tikkie-app-whatsapp-2.png",e.imgwhatsapp3="./images/tikkie-app-whatsapp-3.png",e.imgbank1="./images/tikkie-app-bank-triodos.png",e.imgbank2="./images/tikkie-app-bank-rabobank-sns.png",e.imgbank3="./images/tikkie-app-bank-knab-ing.png",e.imgbank4="./images/tikkie-app-bank-abn.png",e.imgbank5="./images/tikkie-app-bank-alle.png",e.imgidealpay="./images/tikkie-app-ideal-betalen.png",e.imgideallogo="./images/tikkie-app-ideal-logo.png",e.imgdownload="./images/tikkie-app-downloaden.png",e.imgapple="./images/apple.svg",e.imggoogle="./images/google-store.svg",e.imgbuttonarrow="./images/arrow-down-new.svg",e.imgfacebook="./images/facebook.svg",e.imginsta="./images/instagram-icon.svg",e.imgarrow="./images/arrow-copy.png",e.currentYear=(new Date).getFullYear(),e.whatsapp="./images/whats-app-logo.png";switch(r.path()){case"/privacyv2/":e.language="nl",e.newUrlScheme=!1,e.version=2;break;case"/privacy/nl/v2/":e.language="nl",e.newUrlScheme=!0,e.version=2;break;case"/privacy/en/v1/":e.language="en",e.newUrlScheme=!0,e.version=1;break;default:e.language="nl",e.newUrlScheme=!1,e.version=3}var t=this;t.data=n,"ios"==t.data.os?e.os="ios":"android"==t.data.os?e.os="android":e.os="other",e.checkMobileResolution(),e.getCookieSettings()};l()}angular.module("eddieportal").controller("MainController",e),e.$inject=["$scope","scroll","deviceDetector","$window","$http","$cookies","$location","mobileUtils"]}(),function(){function e(e,t,n,a,o,r,s,l,c,g,u,d,p,m,k,h,f,b){function v(e){var t={method:"GET",url:$+"/paymentevent/"+e};a(t).then(function(t){n.name=t.data.orderingPartyName,n.descr=t.data.description;var a=t.data.status,o=t.data.bankAccountThresholdsExceeded,i=t.data.userWarning,r=t.data.paymentEventWarning;switch(o){case"DAILY":gtag("event","Daily limit",{event_category:"Error retail",event_label:n.paymentEventToken}),n.errorState=!0,s.location.href="/#/morgen-opnieuw/";break;case"MONTHLY":gtag("event","Monthly limit",{event_category:"Error retail",event_label:n.paymentEventToken}),n.errorState=!0,"en"===n.language?s.location.href="/#/monthly-limit-reached/":s.location.href="/#/maandelijkse-limiet-bereikt/"}y(a),n.errorState||(t.data.openAmount?(n.openAmount=!0,n.payEnabled=!1,n.maxAmount=t.data.maxAmountPerPersonInCents,n.maxAmountEuros=Math.floor((t.data.maxAmountPerPersonInCents/100).toFixed(2)),n.maxAmountCents=t.data.maxAmountPerPersonInCents%100,n.maxAmountEuros=_(n.maxAmountEuros),n.maxAmountCents<10&&(n.maxAmountCents="0"+n.maxAmountCents)):(n.fixedAmount=!0,n.issuerDown||(n.payEnabled=!0),n.amount=Math.floor((t.data.amountPerPersonInCents/100).toFixed(2)),n.amountInCents=t.data.amountPerPersonInCents%100,n.amount=_(n.amount),n.amountInCents<10&&(n.amountInCents="0"+n.amountInCents)),"RED"!==i&&"RED"!==r||(gtag("event","Blocked payment requst",{event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/geblokkeerd/"),"ORANGE"!==i&&"ORANGE"!==r||(n.showOrangeWarning=!0,gtag("event","warning showed",{event_category:"Payment page retail"})),n.loadSuccess=!0,gtag("event","pageview",{event_category:"Payment page retail",event_label:e}))},function(e){400==e.status?(gtag("event","Tikkie not found",{event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/niet-gevonden/"):(gtag("event","Backend not available",{event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/niet-beschikbaar/")})["finally"](function(){})}function _(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}function y(e){switch(e){case"EXPIRED":gtag("event","Expired payment request",{event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/verlopen/";break;case"MAX_YIELD_REACHED":gtag("event","Maximum amount",{event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/max-bedrag/";break;case"MAX_SUCCESSFUL_PAYMENTS_REACHED":gtag("event","Maximum payments",{event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/max-betalingen/";break;case"CLOSED":gtag("event","Deleted payment request",{event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/bestaat-niet-meer/";break;case"ERROR":gtag("event","Server error",{event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/servererror/";break;case"BLOCKED":gtag("event","Blocked payment requst",{event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/geblokkeerd/"}}function w(){var e={method:"GET",url:$+"/ideal/issuers"};a(e).then(function(e){n.issuers=e.data.issuers,n.issuers.splice(0,0,{id:"0",code:"selectBank",name:n.choose_bank,up:!0}),T()},function(e){gtag("event","Backend not available",{event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/niet-beschikbaar/"})["finally"](function(){})}function T(){var e=m.get("cookieIssuer");if(angular.isDefined(e))for(n.firstPayment=!1,i=1;i<n.issuers.length;i++)n.issuers[i].code===e&&(n.selectedIssuer=n.issuers[i],n.GetSelectedIssuer(n.issuers[i],!0));else n.selectedIssuer=n.issuers[0],n.firstPayment=!0}function A(e,t,o,i){"undefined"!=typeof i&&(i=i.trim(),""===i?n.messageFilled=!1:n.messageFilled=!0),gtag("event","Pay",{event_category:"Payment page retail",event_label:"message_filled_"+n.messageFilled});var r=new Date;if(r.setDate(r.getDate()+365),m.put("cookieIssuer",o.code,{expires:r}),m.put("cookieBankName",o.name,{expires:r}),n.openAmount)var l=Math.round(100*n.openAmountInput),g={issuerCode:t,amountInCents:l,message:i};else var g={issuerCode:t,message:i};var u={method:"POST",url:$+"/ideal/payment/"+e,headers:{"Content-Type":"application/json"},data:g};a(u).then(function(e){s.location.href=e.data.idealPaymentUrl,c(function(){n.payButtonPressed=!1},500),lottie.destroy()},function(t){switch(t.data.errorCode){case 1e3:gtag("event","Server error",{event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/servererror/";break;case 1002:gtag("event","Server error",{event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/servererror/";break;case 1003:gtag("event","Expired payment request",{event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/verlopen/";break;case 1008:gtag("event","Daily limit",{event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/morgen-opnieuw/";break;case 1009:n.openAmount?(n.errorMaxTotalAmount=!0,c(function(){n.payButtonPressed=!1},500),lottie.destroy()):(gtag("event","Maximum amount",{event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/max-bedrag/");break;case 1010:gtag("event","Maximum payments",{event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/max-betalingen/";break;case 1011:h.isSupported&&h.set("issuer",o),gtag("event","iDeal not available",{
event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/ideal-niet-beschikbaar/"+e;break;case 1017:gtag("event","Monthly limit",{event_category:"Error retail",event_label:n.paymentEventToken}),"en"===n.language?s.location.href="/#/monthly-limit-reached/":s.location.href="/#/maandelijkse-limiet-bereikt/";break;default:gtag("event","Cancelled payment",{event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/niet-gelukt/"+e}})["finally"](function(){})}function E(){var e=new Date;e.setDate(e.getDate()+365),m.put("cookieSocial","true",{expires:e}),m.put("cookieTarget","true",{expires:e})}function I(){angular.isUndefined(m.get("cookieTarget"))?(n.showToaster=!0,E()):n.showToaster=!1,"true"==m.get("cookieTarget")&&(n.pixelTarget=!0),"true"==m.get("cookieSocial")&&(n.pixelSocial=!0)}function C(){n.mobile=s.innerWidth<768}function S(e,t){return e+Math.floor(Math.random()*t)}function P(){var e={method:"GET",url:BACKEND_URL+"/message/retail/landing"};a(e).then(function(e){200==e.status&&(n.messageBanner="msg-banner",e.data.emoji?(n.emojiIcon=e.data.emoji,n.emoji="emoji"):(n.emoji="emoji "+e.data.type,n.emojiIcon=""),n.close="./images/Cross.svg",n.temp="",n.body="","en"===n.language?(n.temp=e.data.message.en.body,n.body=o.trustAsHtml(n.temp)):(n.temp=e.data.message.nl.body,n.body=o.trustAsHtml(n.temp)),""!=n.body&&(n.showMessage=!0))})}function x(){n.language=b.browserSettings(),n.languageFile=n.language+".json",n.faqFile=n.language+"_faq.json",n.idealLogo="ideal-logo",n.idealLogo_disabled="ideal-logo disablediDealLogo",n.idealLogo_disabled_2nd="ideal-logo disablediDealLogo",n.payButton_2nd_disabled="pay-button second-time-user disabled",n.payButton_2nd="pay-button second-time-user","en"===n.language?(n.english=!0,n.idealLogo_1st="ideal-logo-"+n.language,n.payButton="pay-button-"+n.language,n.payButton_disabled="pay-button-"+n.language+" disabled",n.payButton_pressed="pay-button-"+n.language+" pressed",n.choose_bank="Choose your bank",n.issuer_maintenance_msg="ðŸ·Settling a night out? Due to maintenance at #bank, iDeal payments may not be possible Sunday morning 1.00 - 6.30 am."):(n.english=!1,n.idealLogo_1st="ideal-logo",n.payButton="pay-button",n.payButton_disabled="pay-button disabled",n.payButton_pressed="pay-button pressed",n.choose_bank="Kies je bank",n.issuer_maintenance_msg="ðŸ·Avondje uit verrekenen? Door onderhoud bij #bank zijn er geen iDeal-betalingen mogelijk op zondagochtend tussen 1.00 en 6.30 uur."),u.content(n.languageFile).then(function(e){n.content=e.data,n.load=n.content.paymentrequest_loading,n.message=n.content.paymentrequest_msg,n.message_open=n.content.paymentrequest_msg_open,n.placeholder_1=n.content.placeholder_1,n.placeholder_2=n.content.placeholder_2,n.placeholder=n.getPlaceholderTxt(),n.cookie_title=n.content.cooke_title,n.cookie_msg=n.content.cooke_msg,n.cookie_link=n.content.cooke_link,n.cookie_msg_end=n.content.cooke_msg_end,n.tagline=n.content.tagline,n["new"]=n.content["new"],n.openamount_banner=n.content.open_amount_banner,n.max_amount_error=n.content.max_amount_error,n.amount_error=n.content.amount_error,n.no_amount_error=n.content.no_amount_error,n.total_amount_error=n.content.total_amount_error,n.to=n.content.to,n.choose_bank=n.content.choose_bank,n.pay_now=n.content.pay_now,n.my_bank=n.content.my_bank,n.accept_msg=n.content.accept_msg,n.accept_msg=o.trustAsHtml(n.accept_msg),n.footer_terms=n.content.footer_terms,n.footer_terms=o.trustAsHtml(n.footer_terms),n.footer_privacy=n.content.footer_privacy,n.footer_privacy=o.trustAsHtml(n.footer_privacy),n.having_trouble=n.content.having_trouble,n.request_warning_title=n.content.request_warning_title,n.request_warning_1=n.content.request_warning_1,n.request_warning_2=n.content.request_warning_2,n.request_warning_3=n.content.request_warning_3,n.suspicious_request_title=n.content.suspicious_request_title,n.suspicious_request_msg=n.content.suspicious_request_msg,n.suspicious_request_link=n.content.suspicious_request_link,n.questions=n.content.any_questions,n.chat=n.content.chat_with_Tikkie_btn,n.ok=n.content.ok_btn,n.sender_unknown_title=n.content.sender_unknown_title,n.sender_unknown_msg=n.content.sender_unknown_msg,n.sender_unknown_msg_end=n.content.sender_unknown_msg_end,n.secure_ideal_title=n.content.secure_payments_title,n.secure_ideal_msg=n.content.secure_payments_msg,n.secure_tikkie_title=n.content.secure_tikkie_title,n.secure_tikkie_msg=n.content.secure_tikkie_msg,n.sender_unknown_head=n.content.sender_unknown_head,n.sender_unknown_list1=n.content.sender_unknown_list1,n.sender_unknown_list2=n.content.sender_unknown_list2,n.sender_unknown_list3=n.content.sender_unknown_list3,n.report_suspicious_title=n.content.report_suspicious_title,n.report_suspicious_msg_1=n.content.report_suspicious_msg_1,n.report_suspicious_msg_2=n.content.report_suspicious_msg_2,n.suspicious_request_link_short=n.content.suspicious_request_link_short,n.pay_again_title=n.content.pay_again_title,n.pay_again_msg=n.content.pay_again_msg,n.pay_again_btn=n.content.pay_again_btn,n.ideal_down_msg=n.content.ideal_down_msg},function(){})}function B(){n.data={message:""},n.charLeft=35,x(),I(),L=r.paymentEventToken.replace(".",""),n.loadSuccess=!1,n.errorState=!1,u.content(n.faqFile).then(function(e){n.panes=e.data,n.items=[];for(var t=0;t<n.panes.length;t++){var a={};a.category=o.trustAsHtml(n.panes[t].category),a.header=o.trustAsHtml(n.panes[t].header),n.input=n.panes[t].content,n.output=n.input.replace("reportAbuse","https://api.whatsapp.com/send?phone=31613768528"),a.content=o.trustAsHtml(n.output),n.items.push(a)}}),$="https://"+k.apiurl(),BACKEND_URL="https://"+k.backendurl(),R=p.protocol()+"://"+k.weburl(),C(),w(),v(L),P(),c(function(){angular.isUndefined(n.issuers)&&0===j&&(w(),j=1)},3e3),n.imgideal="./images/ideal-logo.svg",n.avatarimg="./images/icon_avatar.png",n.imglock="./images/lock.svg",n.imgiconevent="./images/icon-drink.svg",n.imgarrowdown="./images/arrow-down-new.svg",n.imgtikkielogo="./images/logo-tikkie.png",n.imgquestionmark="./images/vraagteken-icon.svg",n.imgabnamro="./images/abn-logo.svg",n.imgloader="./images/loader.gif",n.arrow="./images/arrow-icon.png",n.verifiedmock="./images/img-voorbeeldbedrijf.png",n.questionmark="./images/question.svg",n.whatsapp="./images/whats-app-logo.svg",n.currentYear=(new Date).getFullYear(),n.abTest=M(),n.showOrangeWarning=!1,n.payButtonPressed=!1,n.showName=!1,n.bankSelected=!0,n.showSelectMsg=!1,n.rotated=!1,n.payconfirmed=!1,n.payEnabled=!1,n.firstPayment=!1,n.fixedAmount=!1,n.openAmount=!1,n.openAmountBanner=!0,n.banner=!0,n.errorOpenAmount=!1,n.errorOpenAmountMax=!1,n.errorMaxTotalAmount=!1,n.messageFlippedOpen=!1,n.toggleOffInProd="tikkie.me"!==window.location.host,D()}function D(){n.isCheckedPayment=f.hasTokenBeenPayedBefore(L),n.showGlass=n.isCheckedPayment,n.checkedPaymentGifUri=n.getCheckedPaymentRandomGifUri()}var L="",$="",R="",j=0;n.handleChange=function(e){n.openAmountInput=e,e||void 0===e?n.payEnabled=!0:n.payEnabled=!1},n.handleChangeMessage=function(e,t){angular.isDefined(t)&&t>35?(n.data.message=e.substring(0,35),n.charLeft=0):n.charLeft=35-t},n.testMessageInput=function(e,t){if("Enter"===e.key)e.preventDefault();else{if("Backspace"===e.key||"Delete"===e.key||"ArrowUp"===e.key||"ArrowDown"===e.key||"ArrowLeft"===e.key||"ArrowRight"===e.key||8===e.keyCode||93===e.keyCode||91===e.keyCode||27===e.keyCode||17===e.keyCode||18===e.keyCode||46===e.keyCode||void 0===e.key)return e.key;var a=e.target.value;a.length>34&&(n.charLeft=0,e.preventDefault())}},n.testOpenInput=function(e,t){var n=e.target.value+e.key;return n.match(/^[0-9]*([.|,]{1}[0-9]*)?$/)||"Backspace"===e.key||"Delete"===e.key||8===e.keyCode||46===e.keyCode||void 0===e.key?e.key:void e.preventDefault()},n.checkDecimals=function(e){s.scrollTo(0,0);var t=String(e.target.value),a=Number(e.target.value);a<0&&(a=a*=-1),a=parseFloat(t).toFixed(2),e.target.value=a,0===a?(n.payEnabled=!1,n.errorNoOpenAmount=!0,e.target.value=""):a>n.maxAmount/100&&(e.target.value=(n.maxAmount/100).toFixed(2),n.payEnabled=!1,n.errorOpenAmountMax=!0)},n.GetSelectedIssuer=function(e,t){if(n.selectedBank=e,n.idealIssuerDown=!1,!t){var a=angular.element(document.getElementById("page-top"));l.scrollToElementAnimated(a)}1==e.up?(n.issuerDown=!1,n.firstPayment&&n.setLottie(),"selectBank"!==e.code?n.bankSelected=!0:n.bankSelected=!1,n.firstPayment?n.sendPayment():n.payEnabled=!0):(n.firstPayment?n.payEnabled=!0:n.payEnabled=!1,n.issuerDown=!0,n.idealIssuerDown=!0,n.idealIssuerDown_msg=n.ideal_down_msg.replace("#bank",n.selectedBank.name),n.idealIssuerDown_msg=o.trustAsHtml(n.idealIssuerDown_msg),gtag("event","Ideal issuer down",{event_category:"Payment page retail",event_label:$issuer.name}))},n.showSelectBankMsg=function(){n.showSelectMsg=!0,c(function(){n.showSelectMsg=!1},2e3)},n.sendPayment=function(){if(n.openAmount){var e=n.openAmountInput;100*e>n.maxAmount?(n.errorOpenAmountMax=!0,n.payEnabled=!1):void 0===e?(n.errorOpenAmount=!0,n.payEnabled=!1):(e<0&&(e=n.openAmountInput*=-1),n.payButtonPressed||n.setLottie(),A(L,n.selectedBank.code,n.selectedBank,n.data.message))}else n.payButtonPressed||n.setLottie(),A(L,n.selectedBank.code,n.selectedBank,n.data.message)},n.setLottie=function(){n.payButtonPressed=!0,lottie.loadAnimation({container:document.getElementById("lottie"),renderer:"svg",loop:!0,autoplay:!0,path:"/images/loader-pay.json"})},n.whatsAppTikkie=function(){window.location.href="https://api.whatsapp.com/send?phone=31613768528",gtag("event","WhatsApp Webcare",{event_category:"Payment page retail",event_label:L})},n.scrollToNext=function(){if(n.rotated){var e=angular.element(document.getElementById("page-top"));l.scrollToElementAnimated(e),n.rotated=!0}else{var t=angular.element(document.getElementById("page-how-this-works"));l.scrollToElementAnimated(t),n.rotated=!1}},n.rotate=function(){n.rotated=!n.rotated},n.checkBottomView=function(e,t,a,o){t&&"both"===a&&!n.rotated&&n.rotate(),t&&"top"===a&&!n.rotated&&n.rotate(),!t&&angular.isUndefined(a)&&n.rotate()},n.showWarningOrange=function(){gtag("event","Click orange warning",{event_category:"Payment page retail",event_label:L}),n.showOrangeModal=!0,n.showGlass=!0},n.closeModals=function(){n.showOrangeModal=!1,n.showGlass=!1,n.isCheckedPayment=!1,angular.element(document.getElementById("modal")).remove()},n.closeCookieToaster=function(){n.showToaster=!1},n.closeBanner=function(){n.banner=!1,n.errorOpenAmount=!1,n.errorOpenAmountMax=!1,n.errorNoOpenAmount=!1,n.errorMaxTotalAmount=!1},n.openMessage=function(){n.messageFlippedOpen=!0,n.message_open=n.message_open.replace("#",n.name),gtag("event","Click add message",{event_category:"Payment page retail"})},n.getPlaceholderTxt=function(){txtToTake=Math.floor(2*Math.random())+1;var e="";switch(txtToTake){case 1:e=n.placeholder_1;break;case 2:e=n.placeholder_2;break;default:e=n.placeholder_1}return e},angular.element(s).bind("resize",function(){C()}),n.checkDevice=function(){var e=this;e.data=g,"ios"!==e.data.os&&"android"!==e.data.os&&(gtag("event","Backend not available",{event_category:"Error retail",event_label:n.paymentEventToken}),s.location.href="/#/niet-beschikbaar/")},n.confirmPay=function(){n.payconfirmed=!1};var M=function(){return Math.floor(2*Math.random())+1};n.$on("$locationChangeStart",function(){var e=p.path();"/paymentevent/"===e.substring(0,14)&&"ios"===n.os&&s.open(R+"/#"+e,"_blank")}),n.getCheckedPaymentRandomGifUri=function(){var e=S(1,2),t="../images/";return t+"already-paid-tikkie-0"+e+".gif"},n.closeMessage=function(){n.showMessage=!1},B()}angular.module("eddieportal").controller("PaymentEventCtrl",e),e.$inject=["CONSTANTS","$animate","$scope","$http","$sce","$routeParams","$window","$document","$timeout","deviceDetector","PageContent","$route","$location","$cookies","Api","localStorageService","confirmedPaymentsService","languageSettingsService"]}(),function(){function e(e,t,n,a,o,r,s,l,c,g,u,d,p,m,k,h){function f(e){var a={method:"GET",url:P+"/paymentrequest/"+e+"?withStatus=1"};n(a).then(function(n){var a=n.data.status;v(a,e);var o=n.data.bankAccountYieldedTooFast;1==o&&(gtag("event","Daily limit",{event_category:"Error business",event_label:t.paymentEventToken}),r.location.href="/#/morgen-opnieuw/"),n.data.openAmount?(t.openAmount=!0,t.payEnabled=!1,t.maxAmount=n.data.maxAmountPerPersonInCents,t.maxAmountEuros=Math.floor((n.data.maxAmountPerPersonInCents/100).toFixed(2)),t.maxAmountCents=n.data.maxAmountPerPersonInCents%100,t.maxAmountEuros=b(t.maxAmountEuros),t.maxAmountCents<10&&(t.maxAmountCents="0"+t.maxAmountCents),n.data.minimalAmountPerPersonInCents>1?t.minimumOpenAmount=!0:t.minimumOpenAmount=!1,t.minimumAmount=n.data.minimalAmountPerPersonInCents,t.minAmountEuros=Math.floor((n.data.minimalAmountPerPersonInCents/100).toFixed(2)),t.minAmountCents=n.data.minimalAmountPerPersonInCents%100,t.minAmountEuros=b(t.minAmountEuros),t.minAmountCents<10&&(t.minAmountCents="0"+t.minAmountCents),t.placeholderOpenAmount="0,00"):(t.fixedAmount=!0,t.idealIssuerDown||(t.payEnabled=!0),t.amount=Math.floor((n.data.amountPerPersonInCents/100).toFixed(2)),t.amountInCents=n.data.amountPerPersonInCents%100,t.amount=b(t.amount),t.amountInCents<10&&(t.amountInCents="0"+t.amountInCents)),t.businessDescr=n.data.descriptionPaymentPage,t.businessName=n.data.displayName,null===n.data.logo?t.businessLogo="./images/default-no-logo.png":t.businessLogo=n.data.logo,t.clientPageUrl=n.data.url;var i=new Date;i.setDate(i.getDate()+1),p.put("cookieBusinessUrl",n.data.paymentEventUrl,{expires:i}),gtag("event","pageview",{event_category:"Payment page business",event_label:t.businessName})},function(e){400==e.status?(gtag("event","Tikkie not found",{event_category:"Error business",event_label:t.paymentEventToken}),r.location.href="/#/niet-gevonden/"):(gtag("event","Backend not available",{event_category:"Error business",event_label:t.paymentEventToken}),r.location.href="/#/niet-beschikbaar/")})}function b(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}function v(e,n){switch(e){case"OPEN":break;case"EXPIRED":gtag("event","Expired payment request",{event_category:"Error business",event_label:t.paymentEventToken}),r.location.href="/#/zakelijk-verlopen/"+n;break;case"MAX_YIELD_REACHED":gtag("event","Maximum amount",{event_category:"Error business",event_label:t.paymentEventToken}),r.location.href="/#/max-bedrag/";break;case"MAX_SUCCESSFUL_PAYMENTS_REACHED":gtag("event","Maximum payments",{event_category:"Error business",event_label:t.paymentEventToken}),r.location.href="/#/zakelijk-max-betalingen/"+n;break;case"CLOSED":gtag("event","Deleted payment request",{event_category:"Error business",event_label:t.paymentEventToken}),r.location.href="/#/bestaat-niet-meer/";break;case"ERROR":gtag("event","Server error",{event_category:"Error business",event_label:t.paymentEventToken}),r.location.href="/#/servererror/";break;default:gtag("event","Server error",{event_category:"Error business",event_label:t.paymentEventToken}),r.location.href="/#/servererror/"}}function _(){var e=P,a={method:"GET",url:e+"/ideal/issuers"};n(a).then(function(e){t.issuers=e.data,t.issuers.splice(0,0,{id:"0",code:"selectBank",name:"Kies je bank"}),y()},function(e){gtag("event","Backend not available",{event_category:"Error business",event_label:t.paymentEventToken}),r.location.href="/#/niet-beschikbaar/"})["finally"](function(){})}function y(){var e=p.get("cookieIssuer");if(void 0!=e)for(t.paidBefore=!0,i=1;i<t.issuers.length;i++)t.issuers[i].code==e&&(t.selectedIssuer=t.issuers[i],t.GetSelectedIssuer(t.issuers[i],!0));else t.selectedIssuer=t.issuers[0],t.firstPayment=!0,t.loadSuccess=!0}function w(e,a,o){gtag("event","Pay",{event_category:"Payment page business",event_label:t.businessName});var i=new Date;if(i.setDate(i.getDate()+365),p.put("cookieIssuer",o.code,{expires:i}),p.put("cookieBankName",o.name,{expires:i}),t.openAmount)var s=Math.round(100*t.openAmountInput),c={issuerCode:a,amountInCents:s};else var c={issuerCode:a};var g=P,u={method:"POST",url:g+"/ideal/payment/"+e,headers:{"Content-Type":"application/json"},data:c};n(u).then(function(e){r.location.href=e.data.idealPaymentUrl,l(function(){t.payButtonPressed=!1},500)},function(n){switch(n.data.errorCode){case 1e3:gtag("event","Server error",{event_category:"Error business",event_label:t.paymentEventToken}),r.location.href="/#/servererror/";break;case 1002:gtag("event","Server error",{event_category:"Error business",event_label:t.paymentEventToken}),r.location.href="/#/servererror/";break;case 1003:gtag("event","Expired payment request",{event_category:"Error business",event_label:t.paymentEventToken}),r.location.href="/#/zakelijk-verlopen/"+e;break;case 1008:gtag("event","Daily limit",{event_category:"Error business",event_label:t.paymentEventToken}),r.location.href="/#/morgen-opnieuw/";break;case 1009:gtag("event","Maximum amount",{event_category:"Error business",event_label:t.paymentEventToken}),r.location.href="/#/max-bedrag/";break;case 1010:gtag("event","Maximum payments",{event_category:"Error business",event_label:t.paymentEventToken}),r.location.href="/#/zakelijk-max-betalingen/"+e;break;case 2028:t.errorOpenAmountMin=!0,t.payEnabled=!1;break;case 1011:k.isSupported&&k.set("issuer",o),gtag("event","iDeal not available",{event_category:"Error business",event_label:t.paymentEventToken}),r.location.href="/#/ideal-niet-beschikbaar/"+e;break;default:gtag("event","Cancelled payment",{event_category:"Error business",event_label:t.paymentEventToken}),r.location.href="/#/zakelijk-niet-gelukt/"+e}})["finally"](function(){lottie.destroy()})}function T(){var e=new Date;e.setDate(e.getDate()+365),p.put("cookieSocial","true",{expires:e}),p.put("cookieTarget","true",{expires:e})}function A(){void 0==p.get("cookieTarget")?(t.showToaster=!0,T()):t.showToaster=!1,"true"==p.get("cookieTarget")&&(t.pixelTarget=!0),"true"==p.get("cookieSocial")&&(t.pixelSocial=!0)}function E(){r.innerWidth<768?t.mobile=!0:t.mobile=!1}function I(){var e={method:"GET",url:BACKEND_URL+"/message/business/landing"};n(e).then(function(e){200==e.status&&(t.messageBanner="msg-banner",e.data.emoji?(t.emojiIcon=e.data.emoji,t.emoji="emoji"):(t.emoji="emoji "+e.data.type,t.emojiIcon=""),t.close="./images/Cross.svg",t.temp="",t.body="","en"===t.language?(t.temp=e.data.message.en.body,t.body=a.trustAsHtml(t.temp)):(t.temp=e.data.message.nl.body,t.body=a.trustAsHtml(t.temp)),""!=t.body&&(t.showMessage=!0))})}t.showModal=!1;var C="",S="",P="",x="";t.handleChange=function(e){t.openAmountInput=e,e||void 0===e?t.payEnabled=!0:t.payEnabled=!1},t.testOpenInput=function(e,t){var n=e.target.value+e.key;n.match(/^[0-9]*([.|,]{1}[0-9]*)?$/)||"Backspace"===e.key||"Delete"===e.key||8===e.keyCode||46===e.keyCode||void 0===e.key?e.key:e.preventDefault()},t.checkDecimals=function(e){r.scrollTo(0,0);var n=String(e.target.value),a=Number(e.target.value);a<0&&(a=a*=-1),a=parseFloat(n).toFixed(2),e.target.value=a,0==a?(t.payEnabled=!1,t.errorNoOpenAmount=!0,e.target.value=""):a>t.maxAmount/100?(t.payEnabled=!1,t.errorOpenAmountMax=!0):a<t.minimumAmount/100&&(t.payEnabled=!1,t.errorOpenAmountMin=!0)},t.GetSelectedIssuer=function(e,n){if(t.selectedBank=e,!n){var a=angular.element(document.getElementById("page-top"));s.scrollToElementAnimated(a)}1==e.up?(t.idealIssuerDown=!1,t.firstPayment&&t.setLottie(),"selectBank"!=e.code?t.bankSelected=!0:t.bankSelected=!1,t.firstPayment?t.sendPayment():t.payEnabled=!0):(t.firstPayment?t.payEnabled=!0:t.payEnabled=!1,t.idealIssuerDown=!0,gtag("event","Ideal issuer down",{event_category:"Payment page business",event_label:e.name})),t.loadSuccess=!0},t.sendPayment=function(){if(t.openAmount){var e=t.openAmountInput;100*e>t.maxAmount?(t.errorOpenAmountMax=!0,t.payEnabled=!1):100*e<t.minAmount?(t.errorOpenAmountMin=!0,t.payEnabled=!1):void 0===e?(t.errorOpenAmount=!0,t.payEnabled=!1):(e<0&&(e=t.openAmountInput*=-1),t.payButtonPressed||t.setLottie(),w(C,t.selectedBank.code,t.selectedBank))}else t.payButtonPressed||t.setLottie(),w(C,t.selectedBank.code,t.selectedBank)},t.setLottie=function(){t.payButtonPressed=!0,lottie.loadAnimation({container:document.getElementById("lottie"),renderer:"svg",loop:!0,autoplay:!0,path:"/images/loader-pay.json"})},t.whatsAppTikkie=function(){window.location.href="https://api.whatsapp.com/send?phone=31613768528",gtag("event","WhatsApp Webcare",{event_category:"Payment page business",event_label:C})},t.scrollToNext=function(){if(t.rotated){var e=angular.element(document.getElementById("page-top"));s.scrollToElementAnimated(e),t.rotated=!0}else{var n=angular.element(document.getElementById("page-how-this-works"));s.scrollToElementAnimated(n),t.rotated=!1}},t.rotate=function(){t.rotated=!t.rotated},t.checkBottomView=function(e,n,a,o){n&&"both"==a&&!t.rotated&&t.rotate(),n&&"top"==a&&!t.rotated&&t.rotate(),n||void 0!=a||t.rotate()},t.showABNModal=function(){t.ABNModal=!0,t.showGlass=!0},t.closeABNModal=function(){t.ABNModal=!1,t.showGlass=!1,angular.element(document.getElementById("modal")).remove()},t.showBusinessModal=function(){t.showVerifiedModal=!0,t.showGlass=!0},t.closeBusinessModal=function(){t.showVerifiedModal=!1,t.showGlass=!1,angular.element(document.getElementById("verifiedModal")).remove()},t.focusOnOpenAmount=function(){document.getElementById("openAmount").focus()},t.closeCookieToaster=function(){t.showToaster=!1},t.closeBanner=function(){t.banner=!1,t.errorOpenAmount=!1,t.errorOpenAmountMax=!1,t.errorNoOpenAmount=!1,t.errorOpenAmountMin=!1},angular.element(r).bind("resize",function(){E()}),t.closeMessage=function(){t.showMessage=!1};var B=function(){C=o.paymentEventToken.replace(".",""),g.content("faq.json").then(function(e){t.panes=e.data}),S="https://"+m.apiurl(),BACKEND_URL="https://"+m.backendurl(),P="https://"+m.businessapiurl(),x=d.protocol()+"://"+m.weburl(),E(),_(),f(C),I(),A(),t.imgideal="./images/ideal-logo.svg",t.avatarimg="./images/icon_avatar.png",t.imglock="./images/lock.svg",t.imgiconevent="./images/icon-drink.svg",t.imgarrowdown="./images/arrow-down-new.svg",t.imgtikkielogo="./images/logo-tikkie.png",t.imgquestionmark="./images/vraagteken-icon.svg",t.imgabnamro="./images/abn-logo.svg",t.imgloader="./images/loader.gif",t.imgloaderpay="./images/loader-pay.json",t.imgverified="./images/checkmark.svg",t.whatsapp="./images/whats-app-logo.svg",t.currentYear=(new Date).getFullYear(),t.showVerifiedModal=!1,t.showToaster=!1,t.showName=!1,t.ABNModal=!1,t.bankSelected=!0,t.idealIssuerDown=!1,t.rotated=!1,t.payconfirmed=!1,t.payButtonPressed=!1,t.loadSuccess=!1,t.businessLogo="./images/default-no-logo.png",t.verified=!0,t.payEnabled=!1,t.firstPayment=!1,t.paidBefore=!1,t.fixedAmount=!1,t.openAmount=!1,t.openAmountBanner=!0,t.banner=!0,t.placeholderOpenAmount="0,00",t.minimumOpenAmount=!1,t.errorOpenAmount=!1,t.errorOpenAmountMax=!1,t.errorOpenAmountMin=!1};B()}angular.module("eddieportal").controller("PaymentEventBusinessCtrl",e),e.$inject=["CONSTANTS","$scope","$http","$sce","$routeParams","$window","$document","$timeout","deviceDetector","PageContent","$route","$location","$cookies","Api","localStorageService","$filter"]}(),function(){function e(e,t,n,a,o,i,r,s,l,c,g,u,d,p,m){function k(t){var a={method:"GET",url:e.API_URL+"/paymentevent/"+e.paymentEventToken};n(a).then(function(t){e.name=t.data.orderingPartyName,e.name.toLowerCase().match(/spar uni.*/)&&0==e.business&&(e.business=!0,e.usertype="business",e.businessName=e.name,e.thankYouTitleBusiness="Superbedankt!",e.paidimgbusiness="./images/thumbsup.gif",e.buttonTextBusiness="Terug naar Spar",e.buttonUrlBusiness="nl.socialbrothers.spar://tikkieSucess",e.businessButton=!0),e.getPayment(e.paymentToken)},function(t){gtag("event","Backend not available",{event_category:"Error retail",event_label:e.paymentEventToken}),o.location.href="/#/niet-beschikbaar/"})["finally"](function(){})}function h(){g.setConfirmedPayments(e.paymentEventToken)}var f;document.body.style.backgroundColor="#424380",e.getPayment=function(t){var a={method:"GET",url:e.API_URL+"/ideal/payment/"+t};n(a).then(function(t){switch(e.paymentToken=t.data.token,e.descr=t.data.description,e.paymentStatus=t.data.onlinePaymentStatus,e.imageToken=t.data.imageToken,t.data.imageLocation&&(e.paidimg=t.data.imageLocation,e.personalGif=!0,e.personalTxt=!0),e.paymentStatus){case"NEW":gtag("event","iDeal too busy",{event_category:"Error retail",event_label:e.paymentEventToken}),o.location.href="/#/ideal-te-druk/"+e.paymentToken+"/"+e.paymentEventToken;break;case"NOT_PAID":gtag("event","Cancelled payment",{event_category:"Error retail",event_label:e.paymentEventToken}),o.location.href="/#/niet-gelukt/"+e.paymentEventToken;break;case"ERROR":o.location.href="/#/niet-gelukt/"+e.paymentEventToken;break;case"PENDING":gtag("event","iDeal too busy",{event_category:"Error retail",event_label:e.paymentEventToken}),o.location.href="/#/ideal-te-druk/"+e.paymentToken+"/"+e.paymentEventToken;break;case"PAID":var n=t.data.payerIbanIsKnown;"NO"==n||"TBD"==n?e.ibanKnown=!1:e.ibanKnown=!0,e.getTheme(),e.getCampaign(),e.paymentPaid=!0,e.isPaidPayment||gtag("event","pageview",{event_category:"Thank you page retail",event_label:"ibanKnown "+e.ibanKnown}),m(function(){e.loadSuccess=!0},1e3),u.setPayerPaid(e.paymentToken),h()}},function(t){gtag("event","Backend not available",{event_category:"Error retail",event_label:e.paymentEventToken}),o.location.href="/#/niet-beschikbaar/"})["finally"](function(){})},e.getFeatures=function(){var t={method:"GET",url:e.API_URL+"/toggles/features"};n(t).then(function(t){for(var n=0;n<t.data.length;n++){var a=t.data[n];"cashback-faq"===a&&(e.cashback=!0)}})},e.markImageInappropriate=function(t){var a={inAppropiate:"true"},i={method:"PUT",url:e.API_URL+"/images/"+e.imageToken,headers:{"Content-Type":"application/json"},data:a};n(i).then(function(t){e.showDelete=!1,e.showGlass=!1,e.getSuccessImage(),e.personalGif=!1,e.personalTxt=!1,e.defaultTxt=!0},function(e){o.location.href="/#/niet-beschikbaar/"})["finally"](function(){})},e.showJudgePopup=function(){e.personalGif?(gtag("event","Click GIF",{event_category:"Thank you page retail",event_label:e.imageToken}),e.showPopup=!0,e.showGlass=!0):e.showPopup=!1},e.showDeleteOption=function(){gtag("event","Click delete GIF",{event_category:"Thank you page retail",event_label:e.imageToken}),e.showPopup=!1,e.showDelete=!0,e.showGlass=!0},e.deleteGif=function(){gtag("event","Confirm delete GIF",{event_category:"Thank you page retail",event_label:e.imageToken}),e.markImageInappropriate()},e.closeiDEALModal=function(){e.showPopup=!1,e.showDelete=!1,e.showGlass=!1,angular.element(document.getElementById("modal")).remove()},e.downloadApp=function(t){gtag("event","Download app",{event_category:"Thank you page retail"}),"ios"==e.os?o.location.href="https://itunes.apple.com/nl/app/tikkie/id1112935685?l=nl&ls=1&mt=8":"android"==e.os&&(o.location.href="https://play.google.com/store/apps/details?id=com.abnamro.nl.tikkie"),"appstore"==t?o.location.href="https://itunes.apple.com/nl/app/tikkie/id1112935685?l=nl&ls=1&mt=8":"playstore"==t&&(o.location.href="https://play.google.com/store/apps/details?id=com.abnamro.nl.tikkie")},e.backToApp=function(){"ios"==e.os?o.location.href="tikkie://mixpanel_deeplink/gif_preview":"android"==e.os&&(o.location.href="tikkie://open/gif_preview")},e.getSuccessImage=function(){var t={method:"GET",url:e.BACKEND_URL+"/gif/retail/landing"};n(t).then(function(t){e.paidimg=t.data.gif},function(t){200!=t.status&&(e.paidimg="./images/success-5.gif")})["finally"](function(){})},e.getValentineImage=function(){f=Math.floor(4*Math.random())+1;var e="";switch(f){case 1:e="./images/valentine-1.gif";break;case 2:e="./images/valentine-2.gif";break;case 3:e="./images/valentine-3.gif";break;case 4:e="./images/valentine-4.gif";break;default:e="./images/valentine-4.gif"}return e},e.getCookieSettings=function(){"true"==l.get("cookieTarget")&&(e.pixelTarget=!0),"true"==l.get("cookieSocial")&&(e.pixelSocial=!0)},e.$on("$locationChangeStart",function(){var t=s.path();"/paymentevent/"==t.substring(0,14)&&"ios"==e.os&&o.open(e.WEB_URL+"/#"+t,"_blank")}),e.getTheme=function(){var t=new Date,n=t.getDate(),a=t.getMonth()+1,o=(t.getHours(),0);switch(!0){case e.business===!0:o=0;break;case 14===n&&2===a:e.ibanKnown===!0&&(o=3);break;case n>=29&&6===a||n<=5&&7===a:e.ibanKnown===!1&&(o=5)}e.setTheme(o)},e.setTheme=function(t){switch(t){case 0:document.body.style.backgroundColor="#424380",e.themeGif=!1,e.personalBg="",e.avatar="avatar",e.personalGifText="personal-gif-text",e.descrclass="descr",e.pageFooter="page-footer",e.logoStyle="tikkie-logo",e.tikkieLogo="./images/tikkie-app-logo.png",e.tikkieLogoSize="normal";break;case 1:document.body.style.backgroundColor="#FF8C4D",e.themeGif=!0,e.personalBg="backgroundKing",e.personalGif||(e.paidimg="./images/kingsday.gif"),e.avatar="avatarKing",e.personalGifText="personal-gif-text2",e.descrclass="descr-kingsDay",e.pageFooter="page-footerKing",e.logoStyle="tikkie-logo",e.tikkieLogo="./images/tikkie-app-logo.png",e.tikkieLogoSize="small";break;case 2:document.body.style.backgroundColor="#424380",e.themeGif=!1,e.imgideal="./images/ideal-logo.svg",e.personalBg="",e.avatar="avatar",e.personalGifText="personal-gif-text",e.title="title-donation",e.descrclass="descr-donation",e.pageFooter="page-footer",e.logoStyle="tikkie-logo",e.tikkieLogo="./images/tikkie-app-logo.png",e.tikkieLogoSize="small",e.imgDonation="./images/tikkieRedCrossCyclone.png",e.donation=!0;break;case 3:document.body.style.backgroundColor="#424380",e.themeGif=!0,e.personalBg="",e.personalGif||(e.paidimg=e.getValentineImage()),e.avatar="avatar",e.personalGifText="personal-gif-text",e.descrclass="descr",e.pageFooter="page-footer",e.logoStyle="tikkie-logo",e.tikkieLogo="./images/tikkie-app-logo.png",e.tikkieLogoSize="normal";break;case 4:document.body.style.backgroundColor="#424380",e.themeGif=!0,e.personalBg="",e.personalGif||(e.paidimg="./images/Sinterklaas.gif"),e.avatar="avatar",e.personalGifText="personal-gif-text",e.descrclass="descr",e.pageFooter="page-footer",e.logoStyle="tikkie-logo",e.tikkieLogo="./images/tikkie-app-logo.png",e.tikkieLogoSize="normal",e.thx_title="Bedankt voor je geld",e.thx_msg=" vindt je echt een held!",e.theme_title1="Bedank ",e.theme_title2=" als een baas,",e.theme_msg="met een gedicht van Sinterklaas.",e.buttonLogo="logo_theme4",e.buttonTxt="App dat je betaald hebt",e.download_title="Dat ging makkelijk, vind je niet?",e.download_msg="Daarom een tip, fluistert mijn Piet:";break;case 5:document.body.style.backgroundColor="#424380",e.themeGif=!0,e.personalGif||(e.paidimg="./images/Tompouce.gif"),e.personalBg="",e.avatar="avatar",e.personalGifText="personal-gif-text",e.descrclass="descr",e.pageFooter="page-footer",e.logoStyle="tikkie-logo",e.tikkieLogo="./images/tikkie-app-logo.png",e.tikkieLogoSize="normal",e.downloadBanner=!0,e.imageBanner="./images/HEMA.png",e.eventName="landing_thankyou_clickBannerNoTikkie"}},e.getCampaign=function(){var t={method:"GET",url:e.API_URL+"/campaigns/active?type=web"};n(t).then(function(t){if(e.data=t.data,"web"==e.data.campaignType&&e.data.active){var n=new Date(e.data.dateStart),a=new Date(e.data.dateEnd),o=new Date;if(o>=n&&o<=a){var r="language",s=d.browserSettings();if(e.data.campaignWhatsapp)e.campaign=!0,e.download=!1,e.downloadBanner=!1,e.campaignWhatsapp=!0,e.campaignImage=e.data[r][s].imageUrl,e.campaignMixpanel=e.data.mixpanelEvent,e.whatsappText=e.data[r][s].whatsappText;else if(e.campaignWhatsapp=!1,1==e.data.alwaysShow?e.campaign=!0:0==e.ibanKnown?e.download=!0:e.campaign=!0,e.loadStyles(e.data.styleSheets,e.data.styles),e.campaignTitle=e.data[r][s].title,void 0!=e.campaignTitle&&(e.camTitle=!0),e.campaignSubTitle=e.data[r][s].subTitle,void 0!=e.campaignSubTitle&&(e.camSubTitle=!0),e.campaignButton=e.data[r][s].button,e.campaignButtonBelowImage="below"===e.data.buttonPosition,e.campaignUrl=e.data.url,e.campaignImage=e.data[r][s].imageUrl||e.data.imageUrl,e.faq=e.data[r][s].faq,e.whatsapp=e.data.whatsapp,e.buttonCallToAction=e.data.buttonCallToAction,
e.campaignMixpanel=e.data.mixpanelEvent,"download"===e.data.buttonLogo?"ios"===e.os?e.buttonLogo="./images/apple.svg":"android"===e.os&&(e.buttonLogo="./images/google-store.svg"):"ideal"===e.data.buttonLogo&&(e.buttonLogo="./images/ideal.svg"),void 0!==e.faq){e.items=[];for(var l=0;l<e.faq.length;l++){var c={};c.header=e.faq[l].header,c.content=i.trustAsHtml(e.faq[l].content),e.items.push(c)}}e.personalGif||(void 0!==e.data.gifUrl?e.paidimg=e.data.gifUrl:e.themeGif||e.getSuccessImage())}}else e.personalGif||e.themeGif||e.getSuccessImage(),0==e.ibanKnown&&(e.download=!0)},function(t){e.personalGif||e.themeGif||e.getSuccessImage()})["finally"](function(){})},e.loadStyles=function(e,t){var n=angular.element(document.getElementsByTagName("head")[0]);n.scope().injectedStylesheets||(n.scope().injectedStylesheets=[],n.scope().injectedStyles=[],n.append(p("<link data-ng-repeat='stylesheet in injectedStylesheets' data-ng-href='{{stylesheet}}' rel='stylesheet' type='text/css'/>")(n.scope())),n.append(p("<style data-ng-repeat='style in injectedStyles' type='text/css' ng-bind-html='style'></style>")(n.scope()))),n.scope().injectedStylesheets=e||[],n.scope().injectedStyles=t||[]},e.clickCampaign=function(){window.location.href=e.campaignUrl,gtag("event","View campaign",{event_category:"Thank you page retail",event_label:e.campaignMixpanel})},e.clickCampaignWhatsapp=function(){var t="https://api.whatsapp.com/send?text="+e.whatsappText;window.location.href=t,gtag("event","View campaign",{event_category:"Thank you page retail",event_label:e.campaignMixpanel})},e.clickBanner=function(){window.location.href="https://tikkie.onelink.me/dPTI/tikkielanding",gtag("event",e.eventName,{event_category:"Thank you page retail",event_label:e.usertype})};var b=function(){e.language=d.browserSettings(),e.languageFile=e.language+".json",e.logo="logo_"+e.language,t.content(e.languageFile).then(function(t){e.content=t.data,e.load=e.content.page_loading,e.gif_txt=e.content.personal_gif_txt,e.default_txt=e.content.default_gif_txt,e.thx_title=e.content.thankyou_title,e.thx_msg=e.content.thankyou_msg,e.download_title=e.content.download_title,e.download_msg=e.content.download_msg,e.thx_msg_bus=e.content.thankyou_msg_business,e.popup_gif_title=e.content.popup_gif_title,e.popup_gif_desc=e.content.popup_gif_desc,e.download_btn=e.content.download_btn,e.del_gif=e.content.delete_gif_btn,e.del_gif_title=e.content.delete_gif_title,e.del_gif_desc=e.content.delete_gif_desc,e.change_mind=e.content.delete_gif_no_btn,e.cool_btn=e.content.cool_btn,e.yes_btn=e.content.yes_btn,e.questions=e.content.questions,e.choose_amount_btn=e.content.choose_amount_btn,e.footer_terms_web=e.content.footer_terms_web,e.footer_terms_web=i.trustAsHtml(e.footer_terms_web),e.footer_privacy_web=e.content.footer_privacy_web,e.footer_privacy_web=i.trustAsHtml(e.footer_privacy_web),e.chat_with_Tikkie_btn=e.content.chat_with_Tikkie_btn,e.app_paid_caption=e.content.app_paid}),e.paymentToken=a.paymentToken,e.usertype="retail",e.paidimg="",e.loadSuccess=!1,e.campaign=!1,e.themeGif=!1,e.themefooter=!1,e.paymentEventToken=a.paymentEventToken,e.paymentPaid=!1,e.ibanKnown=!1,e.personalGif=!1,e.camTitle=!1,e.camSubTitle=!1,e.personalTxt=!1,e.defaultTxt=!1,e.API_URL="https://"+c.apiurl(),e.BACKEND_URL="https://"+c.backendurl(),e.WEB_URL=s.protocol()+"://"+c.weburl(),e.BUSINESS_API_URL="https://"+c.businessapiurl(),k(e.paymentEventToken),e.getCookieSettings(),e.imggoogleicon="./images/google-store.svg",e.imgappleicon="./images/apple.svg",e.imgdesktop="./images/asset-desktop@2x.jpg",e.imgloader="./images/loader.gif",e.imgtikkielogo="./images/logo-tikkie.png",e.arrowgif="./images/arrow-copy.png",e.arrowgif2="./images/arrow-popup.svg",e.whatsappBtn="./images/whats-app-logo.png",e.getFeatures(),e.currentYear=(new Date).getFullYear(),e.isPaidPayment=u.hasTokenBeenPayedBefore(e.paymentToken);var n=this;n.data=r,"ios"===n.data.os?e.os="ios":"android"===n.data.os?e.os="android":e.os="other",h()};b()}angular.module("eddieportal").controller("PaymentDoneCtrl",e),e.$inject=["$scope","PageContent","$http","$routeParams","$window","$sce","deviceDetector","$location","$cookies","Api","confirmedPaymentsService","payerPaidService","languageSettingsService","$compile","$timeout"]}(),function(){function e(e,t,n,a,o,i,r,s,l,c,g,u,d,p){function m(t){var a={method:"GET",url:e.BUSINESS_API_URL+"/paymentrequest/"+t};n(a).then(function(t){e.receipt=t.data.showReceipt,e.businessName=t.data.displayName,e.externalId=t.data.externalId,t.data.thankYouImage?e.paidimgbusiness=t.data.thankYouImage:e.paidimgbusiness="./images/thumbsup.gif",t.data.thankYouTitle&&(e.thankYouTitleBusiness=t.data.thankYouTitle,e.thankTitleBusiness=!0),t.data.thankYouContent2&&(e.thankYouContentBusiness2=t.data.thankYouContent2,e.thankContentBusiness2=!0),t.data.thankYouContent&&(e.thankYouContentBusiness=t.data.thankYouContent,e.thankContentBusiness=!0),t.data.thankYouButton&&t.data.thankYouUrl&&!t.data.thankYouAutoRedirect&&(e.businessButton=!0),e.buttonTextBusiness=t.data.thankYouButton,e.buttonUrlBusiness=t.data.thankYouUrl,t.data.thankYouAutoRedirect&&(e.autoRedirect=!0,setTimeout(function(){window.location.href=e.buttonUrlBusiness},2500)),"HORECA"===t.data.businessChannel?(e.horeca=!0,e.usertype="horeca",e.referenceId=t.data.referenceId,e.paidimgbusiness="./images/horeca.gif",e.thankYouTitleBusiness="Betaald, bedankt!",e.thankYouContentBusiness="Je kunt gaan wanneer je wilt.<br/>We hopen dat je genoten hebt!",e.thankYouContentBusiness=i.trustAsHtml(e.thankYouContentBusiness)):e.usertype="business",e.getPayment(e.paymentToken)},function(t){gtag("event","Backend not available",{event_category:"Error business",event_label:e.paymentEventToken}),o.location.href="/#/niet-beschikbaar/"})["finally"](function(){})}function k(t){e.paymentTime=moment(t).locale(e.language).format("D MMM YYYY, H:mm")}function h(t){e.amount=Math.floor((t/100).toFixed(2)),e.amountInCents=t%100,e.amount=f(e.amount),e.amountInCents<10&&(e.amountInCents="0"+e.amountInCents)}function f(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}function b(){u.setConfirmedPayments(e.paymentEventToken)}document.body.style.backgroundColor="#424380",e.getPayment=function(t){var a={method:"GET",url:e.BUSINESS_API_URL+"/ideal/payment/"+t};n(a).then(function(t){switch(e.paymentToken=t.data.token,e.descr=t.data.description,e.paymentStatus=t.data.onlinePaymentStatus,e.paymentId=t.data.id,k(t.data.created),h(t.data.amountInCents),e.paymentStatus){case"NEW":gtag("event","iDeal too busy",{event_category:"Error business",event_label:e.paymentEventToken}),o.location.href="/#/ideal-te-druk/"+e.paymentToken+"/"+e.paymentEventToken;break;case"NOT_PAID":gtag("event","Cancelled payment",{event_category:"Error business",event_label:e.paymentEventToken}),o.location.href="/#/zakelijk-niet-gelukt/"+e.paymentEventToken;break;case"ERROR":o.location.href="/#/zakelijk-niet-gelukt/"+e.paymentEventToken;break;case"PENDING":gtag("event","iDeal too busy",{event_category:"Error business",event_label:e.paymentEventToken}),o.location.href="/#/ideal-te-druk/"+e.paymentToken+"/"+e.paymentEventToken;break;case"PAID":e.getTheme(),e.paymentPaid=!0,e.isPaidPayment||gtag("event","pageview",{event_category:"Thank you page business",event_label:e.businessName}),e.loadSuccess=!0,d.setPayerPaid(e.paymentToken),b(),e.horeca&&e.getOrderDetails()}},function(t){gtag("event","Backend not available",{event_category:"Error business",event_label:e.paymentEventToken}),o.location.href="/#/niet-beschikbaar/"})["finally"](function(){})},e.getOrderDetails=function(){var t={method:"GET",headers:{"Access-Control-Allow-Origin":e.environment},url:e.HORECA_API_URL+"/order/"+e.referenceId};n(t).then(function(t){e.restaurantToken=t.data.restaurantToken,e.brandLogo=c.get(e.restaurantToken),void 0===e.brandLogo?e.getBrandImages():e.brandLogo=decodeURIComponent(e.brandLogo),e.tableNumber=t.data.tableNumber,e.invoiceDate=t.data.currentDateFormatted,t.data.amountPaidInCents>0&&t.data.amountPaidInCents<t.data.totalPriceInCentsVAT&&(e.partialPayment=!0,e.alreadyPaid="Reeds voldaan",e.outstandingAmount="Openstaand bedrag",e.amountOpenInCents=v(t.data.amountOpenInCents),e.amountPaidInCents=v(t.data.amountPaidInCents)),e.rawAmount=t.data.totalPriceInCentsVAT,e.totalAmount=v(t.data.totalPriceInCentsVAT),e.totalExclVat=v(t.data.totalPriceInCents),t.data.totalVatHighInCents>0&&(e.vatHigh=!0,e.totalVatHighInCents=v(t.data.totalVatHighInCents)),t.data.totalVatLowInCents>0&&(e.vatLow=!0,e.totalVatLowInCents=v(t.data.totalVatLowInCents)),e.items=[];for(var n=0;n<t.data.orderItems.length;n++){var a={};a.itemName=t.data.orderItems[n].itemName,a.singlePriceInCentsVAT=v(t.data.orderItems[n].singlePriceInCentsVAT),a.totalPrice=v(t.data.orderItems[n].totalPriceInCentsVAT),a.quantity=t.data.orderItems[n].quantity,e.items.push(a)}e.showHorecaPopup()},function(e){})["finally"](function(){})},e.showHorecaPopup=function(){if(!e.sbx&&!c.get("NPS")){var t=new Date;t.setDate(t.getDate()+100),c.put("NPS","true",{expires:t}),e.showFeedbackPopupBig1=!0,e.showGlassFeedback=!0}},e.getBrandImages=function(){e.brandLogo="";var t={method:"GET",headers:{"Access-Control-Allow-Origin":e.environment},url:e.HORECA_API_URL+"/merchant/"+e.restaurantToken};n(t).then(function(t){e.brandLogo=t.data.merchantLandingPageLogo;var n=new Date;n.setDate(n.getDate()+14),c.put(e.restaurantToken,e.brandLogo,{expires:n})})},e.closeModalFeedback=function(){e.showFeedbackPopupBig1=!1,e.showGlassFeedback=!1},e.selectInitialFeedback=function(t){switch(t){case"will share":e.feedbackScore=t;break;case"might share":e.feedbackScore=t;break;case"will not share":e.feedbackScore=t}e.sendInitialFeedback();var n=new Date;n.setDate(n.getDate()+100),c.put("NPS","true",{expires:n})},e.sendInitialFeedback=function(){gtag("event","web_thankyou_feedbackShareHoreca",{event_category:"Tikkie check",event_feedback_score:e.feedbackScore}),e.showFeedbackPopupBig1=!1,e.showGlassFeedback=!1};var v=function(t){return e.cents=t%100,e.euro=Math.floor(t/100),e.cents<0&&(e.cents=e.cents*-1),e.cents<10&&(e.cents="0"+e.cents),e.euro+","+e.cents};e.downloadApp=function(t){gtag("event","Download app",{event_category:"Thank you page business",event_label:e.paymentEventToken}),"ios"==e.os?o.location.href="https://itunes.apple.com/nl/app/tikkie/id1112935685?l=nl&ls=1&mt=8":"android"==e.os&&(o.location.href="https://play.google.com/store/apps/details?id=com.abnamro.nl.tikkie"),"appstore"==t?o.location.href="https://itunes.apple.com/nl/app/tikkie/id1112935685?l=nl&ls=1&mt=8":"playstore"==t&&(o.location.href="https://play.google.com/store/apps/details?id=com.abnamro.nl.tikkie")},e.goToMerchant=function(){o.location.href=e.buttonUrlBusiness,gtag("event","Click button",{event_category:"Thank you page business",event_label:e.paymentEventToken})},e.goToReceipt=function(){var t=e.HORECA_API_URL+"/receipt/"+e.referenceId;window.open(t),gtag("event","web_thankyou_buttonDownloadReceipt",{event_category:"Tikkie check",event_user_type:e.usertype})},e.numberOfPersons=function(){e.showGlass=!0},e.closeModal=function(){e.showGlass=!1},e.sendTikkie=function(t){void 0===t&&(t=0);var n="tikkie://payment_request?clientId=tikkieCheck&totalAmountInCents="+e.rawAmount+"&numberOfPersons="+t+"&description="+e.businessName+", "+e.tableNumber;o.location.href=n,gtag("event","web_thankyou_buttonSendTikkie",{event_category:"Tikkie check",event_user_type:e.usertype})},e.backToApp=function(){"ios"==e.os?o.location.href="tikkie://mixpanel_deeplink/gif_preview":"android"==e.os&&(o.location.href="tikkie://open/gif_preview")},e.getCookieSettings=function(){"true"==c.get("cookieTarget")&&(e.pixelTarget=!0),"true"==c.get("cookieSocial")&&(e.pixelSocial=!0)},e.$on("$locationChangeStart",function(){var t=l.path();"/paymentevent/"==t.substring(0,14)&&"ios"==e.os&&o.open(e.WEB_URL+"/#"+t,"_blank")}),e.getTheme=function(){var t=0;e.setTheme(t)},e.setTheme=function(t){document.body.style.backgroundColor="#424380",e.themeGif=!1,e.personalBg="",e.avatar="avatar",e.personalGifText="personal-gif-text",e.descrclass="descr",e.pageFooter="page-footer",e.tikkieLogo="./images/tikkie-app-logo.png",e.tikkieLogoSize="normal"},e.donate_freeAmount=function(){window.location.href="https://tikkie.me/pay/RodeKruis/6m0jo9ngen9jn2nv8c7v"},e.setLottie=function(){lottie.loadAnimation({container:document.getElementById("lottie-loader"),renderer:"svg",loop:!0,autoplay:!0,path:"/images/loader-pay.json"})};var _=function(){return Math.floor(2*Math.random())+1};e.getEnvironment=function(){var t="",n=window.location.hostname;t=n.substr(0,3),"sbx"==t&&(e.sbx=!0),"dev"==t||"tst"==t||"acc"==t?e.environment="https://"+t+".tikkie.me":e.environment="https://tikkie.me"};var y=function(){e.language=p.browserSettings(),e.languageFile=e.language+".json",e.faqFile=e.language+"_faq.json",e.logo="logo_"+e.language,t.content(e.languageFile).then(function(t){e.content=t.data,e.load=e.content.page_loading,e.gif_txt=e.content.personal_gif_txt,e.default_txt=e.content.default_gif_txt,e.thx_title_bus=e.content.thankyou_title_bus,e.thx_msg_bus=e.content.thankyou_msg_bus,e.confirmation_statement=e.content.confirmation_statement,e.download_title=e.content.download_title,e.download_msg=e.content.download_msg_bus,e.download_btn=e.content.download_btn,e.popup_gif_title=e.content.popup_gif_title,e.popup_gif_desc=e.content.popup_gif_desc,e.del_gif=e.content.delete_gif_btn,e.del_gif_title=e.content.delete_gif_title,e.del_gif_desc=e.content.delete_gif_desc,e.change_mind=e.content.delete_gif_no_btn,e.cool_btn=e.content.cool_btn,e.yes_btn=e.content.yes_btn,e.questions=e.content.questions,e.choose_amount_btn=e.content.choose_amount_btn,e.footer_terms_web=e.content.footer_terms_web,e.footer_terms_web=i.trustAsHtml(e.footer_terms_web),e.footer_privacy_web=e.content.footer_privacy_web,e.footer_privacy_web=i.trustAsHtml(e.footer_privacy_web),e.chat_with_Tikkie_btn=e.content.chat_with_Tikkie_btn}),e.paymentToken=a.paymentToken,e.paymentEventToken=a.paymentEventToken,e.paymentPaid=!1,e.horeca=!1,e.sbx=!1,e.showGlass=!1,t.content(e.faqFile).then(function(t){e.panes=t.data}),e.defaultTxt=!1,e.WEB_URL=l.protocol()+"://"+g.weburl(),e.BUSINESS_API_URL="https://"+g.businessapiurl(),e.HORECA_API_URL="https://"+g.horecaapiurl(),e.API_URL="https://"+g.apiurl(),e.getEnvironment(),e.getCookieSettings(),e.abTest=_(),1===e.abTest?e.abTest=!0:e.abTest=!1,e.receiptBottom="./images/receipt-end.png",e.paidimgbusiness="./images/thumbsup.gif",e.imggoogleicon="./images/google-store.svg",e.imgappleicon="./images/apple.svg",e.imgdesktop="./images/asset-desktop@2x.jpg",e.imgloader="./images/loader.gif",e.imgtikkielogo="./images/logo-tikkie.png",e.arrowgif="./images/arrow-copy.png",e.whatsapp="./images/whats-app-logo.png",e.checkmark="./images/checkmark.svg",e.feedbackthx="./images/thx.gif",e.close="./images/Cross-grey.svg",e.close2="./images/Cross.svg",e.currentYear=(new Date).getFullYear(),e.receipt=!1,e.thankTitleBusiness=!1,e.thankContentBusiness=!1,e.thankContentBusiness2=!1,e.businessButton=!1,e.autoRedirect=!1,e.externalId="",e.referenceId="",e.descr="",e.isPaidPayment=d.hasTokenBeenPayedBefore(e.paymentToken);var n=this;n.data=s,m(e.paymentEventToken),"ios"===n.data.os?e.os="ios":"android"===n.data.os?e.os="android":e.os="other",b()};y()}angular.module("eddieportal").controller("PaymentDoneBusinessCtrl",e),e.$inject=["$scope","PageContent","$http","$routeParams","$window","$sce","$timeout","deviceDetector","$location","$cookies","Api","confirmedPaymentsService","payerPaidService","languageSettingsService"]}(),function(){function e(e,t,n,a,o,i,r,s){e.getPayment=function(n){var o={method:"GET",url:e.API_URL+"/pay2mobile/ideal/payment/"+n};t(o).then(function(t){switch(e.paymentToken=t.data.token,e.paymentStatus=t.data.paymentStatus,e.payeeName=t.data.payeeName,e.amount=t.data.amountInCents/100,e.amount=e.amount.toFixed(2).replace(".",","),e.cents=e.amount.slice(-2),"00"===e.cents&&(e.amount=e.amount.slice(0,-3)),e.paidimg="./images/success-2.jpg",e.payeeIsVerified=t.data.payeeIsVerified,e.payeeIsVerified===!0&&(e.confirmationTitle="Betaling gelukt!",e.confirmationMessage=e.payeeName+" krijgt jouw â‚¬Â "+e.amount+" binnen 1 werkdag. Jullie hoeven verder niets te doen, handig toch?"),e.payeeIsVerified===!1&&(e.confirmationTitle="Gelukt!",e.confirmationMessage="Jouw â‚¬Â "+e.amount+" is onderweg. We hebben "+e.payeeName+" een sms'je gestuurd. "+e.payeeName+" accepteert je betaling door op de link in de sms te tikken."),e.paymentStatus){case"NEW":a.location.href="/#/ideal-te-druk/"+e.paymentToken+"/"+e.paymentToken;break;case"NOT_PAID":a.location.href="/#/niet-gelukt/"+e.paymentToken;break;case"ERROR":a.location.href="/#/niet-gelukt/"+e.paymentToken;break;case"PENDING":a.location.href="/#/ideal-te-druk/"+e.paymentToken+"/"+e.paymentToken;break;case"PAID":e.paymentPaid=!0;var n=t.data.payerIbanIsKnown;"NO"==n||"TBD"==n?e.ibanKnown=!1:"YES"==n&&(e.ibanKnown=!0),e.loadSuccess=!0;break;case"MONEY_ACCEPTED":e.paymentPaid=!0;var n=t.data.payerIbanIsKnown;"NO"==n||"TBD"==n?e.ibanKnown=!1:"YES"==n&&(e.ibanKnown=!0),e.loadSuccess=!0}},function(e){a.location.href="/#/niet-beschikbaar/"})["finally"](function(){})},e.closeiDEALModal=function(){e.showPopup=!1,e.showDelete=!1,e.showGlass=!1,angular.element(document.getElementById("modal")).remove()},e.backToApp=function(){var t=window.location.hostname,n=t.substr(0,3),o="";if("dev"==n||"tst"==n||"acc"==n)var o="develop";"ios"==e.os?a.location.href=o+"tikkie://?":"android"==e.os&&(a.location.href=o+"tikkie://open")},e.$on("$locationChangeStart",function(){var t=i.path();"/paymentevent/"==t.substring(0,14)&&"ios"==e.os&&a.open(e.WEB_URL+"/#"+t,"_blank")});var l=function(){e.paymentToken=n.paymentToken,e.loadSuccess=!1,e.paymentPaid=!1,e.ibanKnown=!1,e.personalGif=!1,e.personalTxt=!1,e.defaultTxt=!1,e.payeeIsVerified=!1,e.API_URL="https://"+s.apiurl(),e.getPayment(e.paymentToken),e.imggoogleicon="./images/google-store.svg",e.imgappleicon="./images/apple.svg",e.imgdesktop="./images/asset-desktop@2x.jpg",e.imgloader="./images/loader.gif",e.imgtikkielogo="./images/logo-tikkie.png",e.arrowgif="./images/arrow-copy.png",e.whatsapp="./images/whats-app-logo.png",e.abnamro="./images/powered-by-abn.png",e.currentYear=(new Date).getFullYear(),e.customContent=!1;var t=this;t.data=o,"ios"===t.data.os?e.os="ios":"android"===t.data.os?e.os="android":e.os="other"};l()}angular.module("eddieportal").controller("PayConfirmationCtrl",e),e.$inject=["$scope","$http","$routeParams","$window","deviceDetector","$location","$cookies","Api"]}(),function(){function e(e,t,n,a,o,i,r,s,l,c){function g(t){var n={method:"GET",url:BUSINESS_API_URL+"/paymentrequest/"+o.paymentEventToken};c(n).then(function(n){e.name=n.data.displayName,"/zakelijk-max-betalingen/"==t?(n.data.maxPaymentsImage?e.imgerror=n.data.maxPaymentsImage:e.imgerror="./images/overload.gif",n.data.maxPaymentsTitle?e.title=n.data.maxPaymentsTitle:e.title="Sorry, dit betaalverzoek is al betaald",n.data.maxPaymentsContent?(e.showCustomContent=!0,e.customContent=n.data.maxPaymentsContent):e.showMaxPayBusiness=!0):"/zakelijk-verlopen/"==t?(n.data.expiryImage?e.imgerror=n.data.expiryImage:e.imgerror="./images/ijs.gif",n.data.expiryTitle?e.title=n.data.expiryTitle:e.title="Sorry, dit betaalverzoek is verlopen",n.data.expiryContent?(e.showCustomContent=!0,e.customContent=n.data.expiryContent):e.showExpiredBusiness=!0):"/zakelijk-niet-gelukt/"==t&&(n.data.cancellationImage?e.imgerror=n.data.cancellationImage:e.imgerror="./images/oh-no-cat.gif")},function(n){"/zakelijk-max-betalingen/"==t?(e.showMaxPayBusiness=!0,e.title="Sorry, dit betaalverzoek is al betaald",e.imgerror="./images/overload.gif"):"/zakelijk-verlopen/"==t&&(e.showExpiredBusiness=!0,e.title="Sorry, dit betaalverzoek is verlopen",e.imgerror="./images/ijs.gif")})}function u(){"ABNANL2A"==l.get("cookieIssuer")?e.showABN=!0:"RABONL2U"==l.get("cookieIssuer")?e.showRabo=!0:(e.showOther=!0,e.showQuestions=!0)}var d=function(t){switch("/niet-gelukt/"==t.substring(0,13)?t=t.substring(0,13):"/ideal-niet-beschikbaar/"==t.substring(0,24)?(t=t.substring(0,24),e.bankName=l.get("cookieBankName"),void 0==e.bankName&&(e.bankName="")):"/ideal-te-druk/"==t.substring(0,15)?t=t.substring(0,15):"/zakelijk-niet-gelukt/"==t.substring(0,22)?t=t.substring(0,22):"/zakelijk-verlopen/"==t.substring(0,19)?t=t.substring(0,19):"/zakelijk-max-betalingen/"==t.substring(0,25)?t=t.substring(0,25):"/bon-niet-gevonden/"==t.substring(0,19)&&(t=t.substring(0,19)),t){case"/servererror/":e.title="Oeps!",e.imgerror="./images/broken.gif",e.showError=!0,e.showFooter=!0;break;case"/geblokkeerd/":e.title="Geblokkeerd betaalverzoek",e.imgerror="./images/hardlopers3.gif",e.showBlocked=!0,e.showFooter=!0;break;case"/verlopen/":e.title="Sorry, dit betaalverzoek is verlopen",e.imgerror="./images/ijs.gif",e.showExpired=!0,e.showWhatsappButton=!0,e.showFooter=!0;break;case"/zakelijk-verlopen/":e.paymentEventToken=o.paymentEventToken,g(t),e.showFooter=!0;break;case"/niet-beschikbaar/":e.title="Sorry, Tikkie is even niet beschikbaar",e.showServerDown=!0,e.imgerror="./images/server-error.gif",e.showFooter=!0;break;case"/bon-niet-gevonden/":e.title="Sorry, we hebben je bon niet gevonden",e.showNotPaid=!0,e.imgerror="./images/server-error.gif",e.showFooter=!0;break;case"/niet-gevonden/":e.title="Sorry, we kunnen dit betaalverzoek niet vinden",e.imgerror="./images/dog.gif",e.showNotFound=!0,e.showWhatsappButton=!0,e.showFooter=!0;break;case"/bestaat-niet-meer/":e.title="Oeps, dit betaalverzoek lijkt niet meer te bestaan",e.imgerror=p(),e.showNotExist=!0,e.showWhatsappButton=!0,e.showFooter=!0;break;case"/max-bedrag/":e.title="Sorry, dit betaalverzoek werkt niet meer",e.showMaxAmount=!0,e.imgerror="./images/oh-no.gif",e.showWhatsappButton=!0,e.showFooter=!0;break;case"/max-betalingen/":e.title="Het max aantal betalingen is bereikt",e.showMaxPay=!0,e.imgerror="./images/overload.gif",e.showWhatsappButton=!0,e.showFooter=!0;break;case"/zakelijk-max-betalingen/":e.paymentEventToken=o.paymentEventToken,g(t),e.showFooter=!0;break;case"/morgen-opnieuw/":e.title="Daglimiet bereikt, probeer morgen opnieuw",e.showTryAgain=!0,e.imgerror="./images/bye.gif",e.showWhatsappButton=!0,e.showFooter=!0;break;case"/maandelijkse-limiet-bereikt/":e.title="Limiet bereikt, neem contact op met de afzender",e.showMaxPayPerMonth=!0,e.imgerror="./images/bye.gif",e.showWhatsappButton=!1,e.showFooter=!0;break;case"/monthly-limit-reached/":e.title="Limit reached, contact the sender",e.showMaxPayPerMonthEn=!0,e.imgerror="./images/bye.gif",e.showWhatsappButton=!1,e.showFooter=!0;break;case"/niet-gelukt/":e.paymentEventToken=o.paymentEventToken,e.imgerror="./images/niet-gelukt.gif",e.title="Je hebt de betaling geannuleerd",e.showFailed=!1,e.showFooter=!1,e.showSurvey=!0,e.showEventButton=!0,e.imgabn="./images/edentifier.png",e.imgrabo="./images/raboscanner.png",u();break;case"/zakelijk-niet-gelukt/":e.paymentEventToken=o.paymentEventToken,g(t),e.title="Je hebt de betaling geannuleerd",e.showFailed=!1,e.showFooter=!1,e.showSurvey=!0,e.showEventButton=!0,e.imgabn="./images/edentifier.png",e.imgrabo="./images/raboscanner.png",e.isBusiness=!0,u();break;case"/ideal-niet-beschikbaar/":e.paymentEventToken=o.paymentEventToken,e.title="Sorry, je kan nu niet via iDEAL betalen",e.showIdealNA=!0,e.imgerror="./images/oh-no-panda.gif",e.showEventButton=!0,e.showFooter=!1,e.showQuestions=!0;break;case"/ideal-te-druk/":e.paymentEventToken=o.paymentEventToken,e.paymentToken=o.paymentToken,e.title="Drukte bij iDEAL",e.showIdealBusy=!0,e.imgerror="./images/cheering.gif",e.showIDEALRetryButton=!0,e.showFooter=!1,e.showQuestions=!0;break;default:e.title="Sorry, Tikkie is even niet beschikbaar",e.showServerDown=!0,e.imgerror="./images/server-error.gif",e.showFooter=!0}e.errorDescr=i.trustAsHtml(e.errorString)},p=function(){var e=Math.floor(3*Math.random())+1,t="";switch(e){case 1:t="./images/Verzoek-verwijderd-GIF-1.gif";break;case 2:t="./images/Verzoek-verwijderd-GIF-2.gif";break;case 3:t="./images/Verzoek-verwijderd-GIF-3.gif";break;default:t="./images/Verzoek-verwijderd-GIF-1.gif"}return t};e.goToWhatsApp=function(){a.location.href='whatsapp://"'},e.goToPaymentEvent=function(){if(1==e.isBusiness){var t=l.get("cookieBusinessUrl");a.location.href=t}else a.location.href=e.WEB_URL+"/#/pay/"+e.paymentEventToken},e.$watch("survey.answer",function(t){"Anders, namelijk..."==t?e.otherAnswerSelected=!0:e.otherAnswerSelected=!1});var m=function(){a.innerWidth>768&&(e.otherAnswerSelected=!0)};angular.element(a).bind("resize",function(){m()}),e.submitFeedback=function(){console.log(e.survey.answer),void 0!=e.survey.answer&&("Anders, namelijk..."!=e.survey.answer?("Ik heb geen E-dentifier, Rabo Scanner of Digipas bij de hand."==e.survey.answer?s.isSupported&&s.set("answer","edentifier"):s.isSupported&&s.set("answer","other"),a.location.href=e.WEB_URL+"/#/bedankt/"+e.paymentEventToken):e.survey.otherAnswer.length>2&&(a.location.href=e.WEB_URL+"/#/bedankt/"+e.paymentEventToken))},e.goToPaymentDone=function(){a.location.href=e.WEB_URL+"/#/paymentdone/"+e.paymentToken+"/"+e.paymentEventToken},e.downloadApp=function(){"ios"==e.os?a.location.href="https://itunes.apple.com/nl/app/tikkie/id1112935685?l=nl&ls=1&mt=8":"android"==e.os&&(a.location.href="https://play.google.com/store/apps/details?id=com.abnamro.nl.tikkie")},e.goToHome=function(){a.location.href="https://tikkie.me"};var k=function(){e.imgerror="",e.imgapple="./images/apple.svg",e.imggoogle="./images/google-store.svg",e.imggoogleicon="./images/google-store.svg",e.imgappleicon="./images/apple.svg",e.path=t.path(),e.showWhatsappButton=!1,e.showEventButton=!1,e.showIDEALRetryButton=!1,e.showFooter=!1,e.showQuestions=!1,e.showSurvey=!1,e.showNotExist=!1,e.showSubmitButton=!1,e.showEdentifierText=!1,e.survey={},e.showABN=!1,e.showRabo=!1,e.showOther=!1,e.currentYear=(new Date).getFullYear(),e.isBusiness=!1,e.showCustomContent=!1,e.maxPayments=!1,e.API_URL="https://"+r.apiurl(),e.WEB_URL=t.protocol()+"://"+r.weburl(),BUSINESS_API_URL="https://"+r.businessapiurl();var a=this;a.data=n,"ios"===a.data.os?e.os="ios":"android"===a.data.os?e.os="android":e.os="other",m(),d(e.path)};k()}angular.module("eddieportal").controller("ErrorCtrl",e),e.$inject=["$scope","$location","deviceDetector","$window","$routeParams","$sce","Api","localStorageService","$cookies","$http"]}(),function(){function e(e,t,n,a,o,i,r,s){e.getImage=function(){var o={method:"GET",url:e.API_URL+"/images/"+n.imageToken,headers:{"Content-Type":"application/json"}};t(o).then(function(t){e.image=t.data.imageLocation},function(e){a.location.href="/#/niet-beschikbaar/"})["finally"](function(){})},e.downloadApp=function(t){"ios"==e.os?a.location.href="https://itunes.apple.com/nl/app/tikkie/id1112935685?l=nl&ls=1&mt=8":"android"==e.os&&(a.location.href="https://play.google.com/store/apps/details?id=com.abnamro.nl.tikkie"),"appstore"==t?a.location.href="https://itunes.apple.com/nl/app/tikkie/id1112935685?l=nl&ls=1&mt=8":"playstore"==t&&(a.location.href="https://play.google.com/store/apps/details?id=com.abnamro.nl.tikkie")},e.$on("$locationChangeStart",function(){var t=i.path();"/paymentevent/"==t.substring(0,14)&&"ios"==e.os&&a.open(e.WEB_URL+"/#"+t,"_blank")});var l=function(){e.loadSuccess=!0,e.imageToken=n.imageToken,e.userName=n.userName,e.API_URL="https://"+s.apiurl(),e.WEB_URL=i.protocol()+"://"+s.weburl(),e.imggoogleicon="./images/google-store.svg",e.imgappleicon="./images/apple.svg",e.imgdesktop="./images/asset-desktop@2x.jpg",e.imgloader="./images/loader.gif",e.imgtikkielogo="./images/logo-tikkie.png",e.arrowgif="./images/arrow-copy.png",e.currentYear=(new Date).getFullYear();var t=this;t.data=o,"ios"===t.data.os?e.os="ios":"android"===t.data.os?e.os="android":e.os="other",e.getImage()};l()}angular.module("eddieportal").controller("ThankyouCtrl",e),e.$inject=["$scope","$http","$routeParams","$window","deviceDetector","$location","$cookies","Api"]}(),function(){function e(e,t,n){e.goToWhatsApp=function(){t.location.href='whatsapp://"'};var a=function(){e.imgerror="./images/dog.gif",e.imgapple="./images/apple.svg",e.imggoogle="./images/google-store.svg";var a=this;a.data=n,"ios"==a.data.os?e.iOS=!0:e.iOS=!1,"ios"!=a.data.os&&"android"!=a.data.os&&(t.location.href="/#/servererror/")};a()}angular.module("eddieportal").controller("EventNotFoundCtrl",e),e.$inject=["$scope","$window","deviceDetector"]}(),function(){function e(e,t,n,a){function o(e){"/zakelijk/"==e.substring(0,10)?t.location.href="https://www.abnamro.nl/nl/zakelijk/betalen/tikkie/index.html":"/blaren/"==e.substring(0,8)?t.location.href="https://tikkie.me/pay/RodeKruis/7p32Efy32P9QApbBnfz3Xu":"/J4J/"==e.substring(0,5)?t.location.href="https://tikkie.me/pay/JoinforJoy/8WzWQHtn7zJW49eHNPP4E8":"/j4j/"==e.substring(0,5)?t.location.href="https://tikkie.me/pay/JoinforJoy/8WzWQHtn7zJW49eHNPP4E8":"/brandwondenstichting/"==e.substring(0,22)?t.location.href="https://tikkie.me/pay/BrandwSt/jntlar3e9bj71npt2nqj":"/tegenkk/"==e.substring(0,9)&&(t.location.href="https://tikkie.me/pay/TegenKK/vzawwh2jMgwZsAE48CFwEU")}var i=function(){e.imgloader="./images/loader.gif",e.imgtikkielogo="./images/logo-tikkie.png",e.path=a.path(),o(e.path)};i()}angular.module("eddieportal").controller("UrlController",e),e.$inject=["$scope","$window","$http","$location"]}(),function(){function e(e,t,n,a,o,i,r,s,l){e.downloadApp=function(t){"ios"==e.os?a.location.href="https://itunes.apple.com/nl/app/tikkie/id1112935685?l=nl&ls=1&mt=8":"android"==e.os&&(a.location.href="https://play.google.com/store/apps/details?id=com.abnamro.nl.tikkie"),"appstore"==t?a.location.href="https://itunes.apple.com/nl/app/tikkie/id1112935685?l=nl&ls=1&mt=8":"playstore"==t&&(a.location.href="https://play.google.com/store/apps/details?id=com.abnamro.nl.tikkie")},e.getUrlParams=function(){var e=i.url();return e},e.openDeeplink=function(){var t=e.getUrlParams().substring(11,e.getUrlParams().length),n=window.location.hostname,o=n.substr(0,3),i="";if(l(function(){e.loadSuccess=!0},1e4),"dev"==o||"tst"==o||"acc"==o)var i="develop";a.location.href=i+"tikkie://cashback?"+t};var c=function(){e.loadSuccess=!1,e.imggoogleicon="./images/google-store.svg",e.imgappleicon="./images/apple.svg",e.imgdesktop="./images/asset-desktop@2x.jpg",e.imgloader="./images/loader.gif",e.imgtikkielogo="./images/logo-tikkie.png",e.arrowgif="./images/arrow-copy.png",e.gif="./images/download-app.gif",e.currentYear=(new Date).getFullYear();var t=this;t.data=o,"ios"===t.data.os?e.os="ios":"android"===t.data.os?e.os="android":e.os="other",e.openDeeplink()};c()}angular.module("eddieportal").controller("CashbackCtrl",e),e.$inject=["$scope","$http","$routeParams","$window","deviceDetector","$location","$cookies","Api","$timeout"]}(),function(){function e(e,t,n,a,o,i,r,s){e.downloadApp=function(t){"ios"==e.os?(n.location.href="https://itunes.apple.com/nl/app/tikkie/id1112935685?l=nl&ls=1&mt=8",gtag("event","Download_app_via_cashback",{event_category:"iOS"})):"android"==e.os&&(n.location.href="https://play.google.com/store/apps/details?id=com.abnamro.nl.tikkie",gtag("event","Download_app_via_cashback",{event_category:"Android"})),"appstore"==t?(n.location.href="https://itunes.apple.com/nl/app/tikkie/id1112935685?l=nl&ls=1&mt=8",gtag("event","Download_app_via_cashback",{event_category:"iOS"})):"playstore"==t&&(n.location.href="https://play.google.com/store/apps/details?id=com.abnamro.nl.tikkie",gtag("event","Download_app_via_cashback",{event_category:"Android"}))};var l=function(){e.loadSuccess=!0,gtag("event","pageview",{event_category:"Cashback"}),e.imggoogleicon="./images/google-store.svg",e.imgappleicon="./images/apple.svg",e.imgdesktop="./images/asset-desktop@2x.jpg",e.imgloader="./images/loader.gif",e.imgtikkielogo="./images/logo-tikkie.png",e.arrowgif="./images/arrow-copy.png",e.gif="./images/download-app.gif",e.currentYear=(new Date).getFullYear();var t=this;t.data=a,"ios"===t.data.os?e.os="ios":"android"===t.data.os?e.os="android":e.os="other"};l()}angular.module("eddieportal").controller("CashbackBrandsCtrl",e),
e.$inject=["$scope","$http","$window","deviceDetector","$location","$cookies","Api","$timeout"]}(),function(){function e(e,t,n,a,o,i,r,s){e.downloadApp=function(t){"ios"==e.os?(n.location.href="https://itunes.apple.com/nl/app/tikkie/id1112935685?l=nl&ls=1&mt=8",gtag("event","Download_app_via_cashback",{event_category:"iOS"})):"android"==e.os&&(n.location.href="https://play.google.com/store/apps/details?id=com.abnamro.nl.tikkie",gtag("event","Download_app_via_cashback",{event_category:"Android"})),"appstore"==t?(n.location.href="https://itunes.apple.com/nl/app/tikkie/id1112935685?l=nl&ls=1&mt=8",gtag("event","Download_app_via_cashback",{event_category:"iOS"})):"playstore"==t&&(n.location.href="https://play.google.com/store/apps/details?id=com.abnamro.nl.tikkie",gtag("event","Download_app_via_cashback",{event_category:"Android"}))},e.getUrlParams=function(e){var t=o.url();return t},e.openDeeplink=function(t){var a=e.getUrlParams().substring(8),o=window.location.hostname,i=o.substr(0,3),r="";if("dev"==i||"tst"==i||"acc"==i)var r="develop";if("ios"===e.os||"appstore"===t)n.location.href="https://tikkie.me/cashback-ads/digital-cc-no-calories-02012020";else if("android"===e.os||"playstore"===t){var s=r+"tikkie://cashback-ads/"+a;n.location.href=s}};var l=function(){e.loadSuccess=!0,gtag("event","pageview",{event_category:"Cashback"}),e.imggoogleicon="./images/google-store.svg",e.imgappleicon="./images/apple.svg",e.imgdesktop="./images/asset-desktop@2x.jpg",e.imgloader="./images/loader.gif",e.imgtikkielogo="./images/logo-tikkie.png",e.arrowgif="./images/arrow-copy.png",e.gif="./images/download-app.gif",e.currentYear=(new Date).getFullYear();var t=this;t.data=a,"ios"===t.data.os?e.os="ios":"android"===t.data.os?e.os="android":e.os="other"};l()}angular.module("eddieportal").controller("CashbackSocialCtrl",e),e.$inject=["$scope","$http","$window","deviceDetector","$location","$cookies","Api","$timeout"]}(),function(){function e(e,t,n,a,o,i,r,s){e.downloadApp=function(t){"ios"==e.os?n.location.href="https://itunes.apple.com/nl/app/tikkie/id1112935685?l=nl&ls=1&mt=8":"android"==e.os&&(n.location.href="https://play.google.com/store/apps/details?id=com.abnamro.nl.tikkie"),"appstore"==t?n.location.href="https://itunes.apple.com/nl/app/tikkie/id1112935685?l=nl&ls=1&mt=8":"playstore"==t&&(n.location.href="https://play.google.com/store/apps/details?id=com.abnamro.nl.tikkie")};var l=function(){e.loadSuccess=!0,e.imggoogleicon="./images/google-store.svg",e.imgappleicon="./images/apple.svg",e.imgdesktop="./images/asset-desktop@2x.jpg",e.imgloader="./images/loader.gif",e.imgtikkielogo="./images/logo-tikkie.png",e.arrowgif="./images/arrow-copy.png",e.gif="./images/download-app.gif",e.currentYear=(new Date).getFullYear();var t=this;t.data=a,"ios"===t.data.os?e.os="ios":"android"===t.data.os?e.os="android":e.os="other"};l()}angular.module("eddieportal").controller("OpenAppCtrl",e),e.$inject=["$scope","$http","$window","deviceDetector","$location","$cookies","Api","$timeout"]}(),function(){function e(e,t,n,a,o,i,r){function s(e){if(e in p)return void(t.location.href=p[e]);if("dashboard"===e)return gtag("event","horeca_redirect_toDashboard",{event_category:"Tikkie check"}),void(t.location.href="https://smartqueue.nl/admin");if("taphuys"===e)return void(t.location.href="/horeca/taphuys");var n={method:"GET",url:l+"/horeca/"+e};a(n).then(function(e){u=e.data.restaurantToken,u in d&&(u=d[u]);var n=g?"viaQr":"viaUrl";gtag("event","horeca_redirect_"+n,{event_category:"Tikkie check",event_restaurant:u}),t.location.href="/horeca/"+u},function(e){404==e.status?(gtag("event","horeca_redirect_restaurantNotFound",{event_category:"Tikkie check"}),t.location.href="/#/niet-gevonden/"):(gtag("event","horeca_redirect_backendDown",{event_category:"Tikkie check"}),t.location.href="/#/niet-beschikbaar/")})["finally"](function(){})}var l="",c="",g=!1,u="",d={"ca96d7fe-41b0-494b-a8c2-ad5c11337aa3":"YDUUmYu1Zh","6d11fd6f-60f4-466c-bb19-e51b2c764c8d":"KhXQuZEpv5","b41ec135-eaec-4caf-acf0-624742b87b40":"vG85xiPSFH","4c59a3b0-911c-449f-ab20-a836d067caab":"Y0ZZOcHo15","8512f525-4e81-4e86-a99c-a4dbfd0176e8":"0nywnnsmt6","f6251210-7e85-4208-a542-2453bee336b4":"umr5mPXX2T","6b3acc24-f84d-4b09-ad1e-a3f3e0656849":"V5IUA37EZm","1897ced5-72b9-4c85-9bb0-49785dcdd324":"FiyLhexYAl","2ef95fb6-77a8-4b40-9fde-dee561d4dc33":"Sebc9JFhaU","a8749c9c-b02d-4730-8d9e-2b539f6de9b5":"itnBolcYiD","9ffdae57-8101-4eeb-8e1b-931113d3c669":"C8II7absCR","5551e808-050f-481c-b1a9-dc2cff2a3f0d":"PXNq6GIaWZ","493b3811-48d9-4efe-8cb2-556842a1df3f":"Euk3w0GbR6","1a7081a7-2852-43b5-ad43-a889c2693a65":"RetXGleGe0","929d1071-0fee-45b9-b8e9-0578ca59341d":"kqyS5xauOS","8069afbb-6091-4e4f-afca-c994c35b483a":"upKKiDg4Ru","c2bc5c3a-8338-4d38-9c72-e7b91c89fc39":"HQjVT6vkAC","2a403bd2-e334-4d63-b3ce-78eeaee7a268":"2xbRjenzzT"};const p={"pieterse-vectron":"https://sbx.tikkie.me/horeca/cf087bc5-1e50-4506-ba90-41b98ff9ba23","pieterse-mplus":"https://sbx.tikkie.me/horeca/64486bb5-91b8-4c8a-b684-c910947ffe56","leza-mplus":"https://sbx.tikkie.me/horeca/592ccce7-a22f-475f-a485-e7de0cf6331d",nuus:"https://sbx.tikkie.me/horeca/9e712b9b-6945-43bf-9406-28002b2349b2",stn:"https://sbx.tikkie.me/horeca/b47ac332-65f7-4fff-ab47-bce65f9a132c",evers:"https://sbx.tikkie.me/horeca/fe5ccb96-1d1f-48c5-ac3a-ae03d7cd9aa1",weka:"https://sbx.tikkie.me/horeca/c760fac1-017f-4f1a-a345-dc1dc9ea78b9",adnamics:"https://sbx.tikkie.me/horeca/3f0c917a-7dc7-43ee-8dcc-7ce24589f3be",demo:"https://sbx.tikkie.me/horeca/YDUUmYu1Zh"};var m=function(){e.loadSuccess=!1,e.imgtikkielogo="./images/logo-tikkie.png",e.imgloader="./images/loader.gif",e.language="nl",e.languageFile=e.language+".json",r.content(e.languageFile).then(function(t){e.content=t.data,e.loading=e.content.page_loading})},k=function(){m(),l="https://"+o.businessapiurl(),c=i.shortName,g="/qr"===n.path().slice(-3),s(c)};k()}angular.module("eddieportal").controller("CheckRedirectController",e),e.$inject=["$scope","$window","$location","$http","Api","$routeParams","PageContent"]}(),function(){function e(e,t,n,a,o,i,r,s,l,c,g){function u(){t({method:"GET",headers:{"Access-Control-Allow-Origin":e.environment},url:S+"/ideal/issuers"}).then(function(t){e.issuers=t.data,e.issuers.splice(0,0,{id:"0",code:"selectBank",name:e.choose_bank,up:!0}),d()},function(e){console.error(e),o.location.href="/#/niet-beschikbaar/"})}function d(){var t=l.get("cookieIssuer");if(angular.isDefined(t)){var n=e.issuers.filter(function(e){return e.code===t})[0];n&&(e.selectedIssuer=n,e.setSelectedIssuer(n,!0))}else e.selectedIssuer=e.issuers[0]}function p(){t({method:"GET",headers:{"Access-Control-Allow-Origin":e.environment},url:S+"/idealqr/"+E()}).then(function(t){e.idealQr=t.data,h()},function(e){console.error(e),b(e)})}function m(){e.mobile=o.innerWidth<768}function k(e){var t=Math.floor((e/100).toFixed(2)),n=e%100;return t=f(t),n<10&&(n="0"+n),{amount:t,amountInCents:n}}function h(){if(e.idealQr)if(e.idealQr.amountChangeable){var t=k(e.idealQr.minAmountInCents);e.minAmount=t.amount,e.minAmountInCents=t.amountInCents;var n=k(e.idealQr.maxAmountInCents);e.maxAmount=n.amount,e.maxAmountInCents=n.amountInCents}else{var a=k(e.idealQr.amountInCents);e.amount=a.amount,e.amountInCents=a.amountInCents}}function f(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}function b(e){404===e.status?o.location.href="/#/niet-gevonden/":o.location.href="/#/niet-beschikbaar/"}function v(){e.language=g.browserSettings(),e.languageFile=e.language+".json",e.faqFile=e.language+"_faq.json",e.idealLogo="ideal-logo",e.idealLogo_disabled="ideal-logo disablediDealLogo",e.idealLogo_disabled_2nd="ideal-logo disablediDealLogo",e.payButton_2nd_disabled="pay-button second-time-user disabled",e.payButton_2nd="pay-button second-time-user","en"===e.language?(e.english=!0,e.idealLogo_1st="ideal-logo-"+e.language,e.payButton="pay-button-"+e.language,e.payButton_disabled="pay-button-"+e.language+" disabled",e.payButton_pressed="pay-button-"+e.language+" pressed",e.choose_bank="Choose your bank"):(e.english=!1,e.idealLogo_1st="ideal-logo",e.payButton="pay-button",e.payButton_pressed="pay-button pressed",e.choose_bank="Kies je bank"),s.content(e.languageFile).then(function(t){e.content=t.data,e.load=e.content.paymentrequest_loading,e.cookie_title=e.content.cooke_title,e.cookie_msg=e.content.cooke_msg,e.cookie_link=e.content.cooke_link,e.cookie_msg_end=e.content.cooke_msg_end,e.openamount_banner=e.content.open_amount_banner,e.max_amount_error=e.content.max_amount_error,e.min_amount_error=e.content.min_amount_error,e.amount_error=e.content.amount_error,e.no_amount_error=e.content.no_amount_error,e.total_amount_error=e.content.total_amount_error,e.pay_now=e.content.pay_now,e.footer_terms=e.content.footer_terms,e.footer_terms=n.trustAsHtml(e.footer_terms),e.footer_privacy=e.content.footer_privacy,e.footer_privacy=n.trustAsHtml(e.footer_privacy),e.suspicious_request_title=e.content.suspicious_request_title,e.suspicious_request_msg=e.content.suspicious_request_msg,e.suspicious_request_link=e.content.suspicious_request_link,e.ok=e.content.ok_btn,e.having_trouble_simulator=e.content.having_trouble_simulator,e.payment_information=e.content.payment_information,e.scan_ideal_qr_quickly=e.content.scan_ideal_qr_quickly,e.amount_label=e.content.amount_label,e.receiver=e.content.receiver,e.description=e.content.description,e.preferred_bank=e.content.preferred_bank},function(){})}function _(){e.imgideal="./images/ideal-logo.svg",e.imgtikkielogo="./images/logo-tikkie.png",e.imgloader="./images/loader.gif",e.verifiedmock="./images/img-voorbeeldbedrijf.png",e.whatsapp="./images/whats-app-logo.svg",e.idealQrIcon="./images/qr-icon.png",e.currentYear=(new Date).getFullYear(),e.payButtonPressed=!1}function y(){e.showName=!1,e.showSelectMsg=!1,e.openAmountBanner=!0,e.banner=!0,e.errorOpenAmount=!1,e.errorOpenAmountMax=!1,e.errorOpenAmountMin=!1,e.messageFlippedOpen=!1,e.toggleOffInProd="tikkie.me"!==window.location.host}function w(){var t="",n=window.location.hostname;t=n.substr(0,3),"dev"==t||"tst"==t||"acc"==t?e.environment="https://"+t+".tikkie.me":e.environment="https://tikkie.me"}function T(){var e=new Date;e.setDate(e.getDate()+365),l.put("cookieSocial","true",{expires:e}),l.put("cookieTarget","true",{expires:e})}function A(){angular.isUndefined(l.get("cookieTarget"))?(e.showToaster=!0,T()):e.showToaster=!1,"true"==l.get("cookieTarget")&&(e.pixelTarget=!0),"true"==l.get("cookieSocial")&&(e.pixelSocial=!0)}function E(){return a.qrId.replace(".","")}function I(){e.data={message:""},v(),A(),s.content(e.faqFile).then(function(t){e.panes=t.data,e.items=[];for(var a=0;a<e.panes.length;a++){var o={};o.category=n.trustAsHtml(e.panes[a].category),o.header=n.trustAsHtml(e.panes[a].header),e.input=e.panes[a].content,e.output=e.input.replace("reportAbuse","https://api.whatsapp.com/send?phone=31613768528"),o.content=n.trustAsHtml(e.output),e.items.push(o)}}),w(),m(),u(),p(),_(),y(),C()}function C(){r(function(){angular.isUndefined(e.issuers)&&0===x&&(u(),x=1),angular.isUndefined(e.issuers)&&0===B&&(p(P),B=1)},3e3)}var S="https://"+c.businessapiurl(),P="",x=0,B=0;e.handleAmountChange=function(t){e.openAmountInput=100*t},e.testOpenInput=function(e){var t=e.target.value+e.key;t.match(/^[0-9]*([.|,]{1}[0-9]*)?$/)||"Backspace"===e.key||"Delete"===e.key||8===e.keyCode||46===e.keyCode||void 0===e.key?e.key:e.preventDefault()},e.checkDecimals=function(t){o.scrollTo(0,0);var n=String(t.target.value),a=Number(t.target.value);a<0&&(a=a*=-1),a=parseFloat(n).toFixed(2),t.target.value=a,0===a?(e.errorOpenAmountMin=!0,t.target.value=""):a>e.idealQr.maxAmountInCents/100?e.errorOpenAmountMax=!0:a<e.idealQr.minAmountInCents/100&&(e.errorOpenAmountMin=!0)},e.setSelectedIssuer=function(t){e.selectedIssuer=t},e.createIdealTransaction=function(){t({method:"POST",headers:{"Access-Control-Allow-Origin":e.environment},url:S+"/idealqr/transaction",data:{qrId:E(),description:e.idealQr.description,purchaseId:e.idealQr.referenceId,issuer:e.selectedIssuer.code,amount:e.idealQr.amountChangeable?(e.openAmountInput/100).toFixed(2):(e.idealQr.amountInCents/100).toFixed(2)}}).then(function(t){console.info(t),o.location.href=t.data.url,r(function(){e.payButtonPressed=!1},500)},function(e){console.error(e),b(e)})},e.closeModals=function(){e.showGlass=!1,angular.element(document.getElementById("modal")).remove()},e.closeCookieToaster=function(){e.showToaster=!1},e.closeBanner=function(){e.banner=!1,e.errorOpenAmountMin=!1,e.errorOpenAmountMax=!1},angular.element(o).bind("resize",function(){m()}),e.$on("$viewContentLoaded",function(){I()})}angular.module("eddieportal").controller("IdealQrSimulatorController",e),e.$inject=["$scope","$http","$sce","$routeParams","$window","$document","$timeout","PageContent","$cookies","Api","languageSettingsService"]}(),function(){function e(e,t,n,a){var o=n.paymentToken,i=n.userId,r={method:"GET",url:"https://"+a.businessapiurl()+"/idealqr/"+i+"/paymentdone/"+o};t(r).then(function(t){e.location.href=t.data.redirectUrl},function(t){e.location.href="/#/niet-beschikbaar/"})}angular.module("eddieportal").controller("IdealQrPaymentDoneCtrl",e),e.$inject=["$window","$http","$routeParams","Api"]}();